;; disassembly of irrxfw-0x0244.irrfx from the AppleTV 2.1 update
;; (C) 2008 Peter Korsgaard <jacmet@sunsite.dk>
;;
;; Create by m8cdas from http://m8cutils.sf.net/
;; and a lot of blood, sweat and tears ;)
;;
;; To reproduce:
;; wget http://mesu.apple.com/data/IR/694-5484.20080708.hnji4/irrxfw-0x0244.irrxfw
;; m8cdas irrxfw-0x0244.irrxfw > irrxfw-0x0244.asm
;;
0000  7D 13 E5	LJMP	0x13E5 	; bootLoaderVerify
0003  30	HALT
0004  80 7B	JMP	0x0080	; POR
0006  30	HALT
0007  30	HALT
0008  80 7B	JMP	0x0084 	; INT0
000A  7E	RETI
000B  30	HALT
000C  80 7B	JMP	0x0088	; SPI empty
000E  7E	RETI
000F  30	HALT
0010  80 7B	JMP	0x008C	; SPI full
0012  7E	RETI
0013  30	HALT
0014  80 7B	JMP	0x0090 	; GPIO0
0016  7E	RETI
0017  30	HALT
0018  80 7B	JMP	0x0094	; GPIO1
001A  7E	RETI
001B  30	HALT
001C  80 7B	JMP	0x0098 	; INT1
001E  7E	RETI
001F  30	HALT
0020  7D 13 93	LJMP	0x1393	; EP0
0023  7E	RETI
0024  7D 13 A3	LJMP	0x13A3	; EP1
0027  7E	RETI
0028  7D 13 B5	LJMP	0x13B5	; EP2
002B  7E	RETI
002C  7D 13 81	LJMP	0x1381	; USB reset
002F  7E	RETI
0030  7D 13 C7	LJMP	0x13C7	; USB active
0033  7E	RETI
0034  80 7B	JMP	0x00B0	; 1ms timer
0036  7E	RETI
0037  30	HALT
0038  80 7B	JMP	0x00B4	; PIT
003A  7E	RETI
003B  30	HALT
003C  80 7B	JMP	0x00B8	; timer capture 0
003E  7E	RETI
003F  30	HALT
0040  80 7B	JMP	0x00BC 	; timer capture 1
0042  7E	RETI
0043  30	HALT
0044  80 7B	JMP	0x00C0	; 16bit timer
0046  7E	RETI
0047  30	HALT
0048  80 7B	JMP	0x00C4	; INT2
004A  7E	RETI
004B  30	HALT
004C  80 7B	JMP	0x00C8	; PS2 data low
004E  7E	RETI
004F  30	HALT
0050  80 7B	JMP	0x00CC	; GPIO2
0052  7E	RETI
0053  30	HALT
0054  80 7B	JMP	0x00D0	; GPIO3
0056  7E	RETI
0057  30	HALT
0058  80 7B	JMP	0x00D4	; reserved
005A  7E	RETI
005B  30	HALT
005C  80 7B	JMP	0x00D8	; reserved
005E  7E	RETI
005F  30	HALT
0060  80 7B	JMP	0x00DC	; reserved
0062  7E	RETI
0063  30	HALT
0064  80 7B	JMP	0x00E0 	; sleep timer
0066  7E	RETI
0067  30	HALT
0068  30	HALT
0069  30	HALT
006A  30	HALT
006B  30	HALT
006C  30	HALT
006D  30	HALT
006E  30	HALT
006F  30	HALT
0070  30	HALT
0071  30	HALT
0072  30	HALT
0073  30	HALT
0074  30	HALT
0075  30	HALT
0076  30	HALT
0077  30	HALT
0078  30	HALT
0079  30	HALT
007A  30	HALT
007B  30	HALT
007C  30	HALT
007D  30	HALT
007E  30	HALT
007F  30	HALT
0080  30	HALT
0081  30	HALT
0082  30	HALT
0083  30	HALT
0084  7D 03 FE	LJMP	0x03FE	; int0_handler
0087  7E	RETI
0088  7E	RETI		; SPI empty
0089  30	HALT
008A  30	HALT
008B  30	HALT
008C  7E	RETI		; SPI full
008D  30	HALT
008E  30	HALT
008F  30	HALT
0090  7D 04 01	LJMP	0x0401 	; gpio0_handler
0093  7E	RETI
0094  7D 04 02	LJMP	0x0402	; gpio1_handler
0097  7E	RETI
0098  7D 03 FF	LJMP	0x03FF 	; int1_handler
009B  7E	RETI
009C  7D 19 A6	LJMP	0x19A6 	; _USB_EP0_ISR
009F  7E	RETI
00A0  7D 16 CF	LJMP	0x16CF	; _USB_EP1_ISR
00A3  7E	RETI
00A4  7D 16 DA	LJMP	0x16DA	; _USB_EP2_ISR
00A7  7E	RETI
00A8  7D 16 E5	LJMP	0x16E5	; _USB_RESET_ISR
00AB  7E	RETI
00AC  7D 16 EF	LJMP	0x16EF 	; userUsbActivity
00AF  7E	RETI
00B0  7D 0D B8	LJMP	0x0DB8 	; handle_1ms
00B3  7E	RETI
00B4  7E	RETI		; PIT
00B5  30	HALT
00B6  30	HALT
00B7  30	HALT
00B8  7D 0A 58	LJMP	0x0A58	; handle_timer_cap0
00BB  7E	RETI
00BC  7E	RETI		; timer capture 1
00BD  30	HALT
00BE  30	HALT
00BF  30	HALT
00C0  7D 0A 50	LJMP	0x0A50 	; timer16_handler
00C3  7E	RETI
00C4  7D 04 00	LJMP	0x0400 	; int2_handler
00C7  7E	RETI
00C8  7E	RETI		; PS2 data low
00C9  30	HALT
00CA  30	HALT
00CB  30	HALT
00CC  7D 04 06	LJMP	0x0406	; gpio2_handler
00CF  7E	RETI
00D0  7D 04 07	LJMP	0x0407	; gpio3_handler
00D3  7E	RETI
00D4  7E	RETI		; reserved
00D5  30	HALT
00D6  30	HALT
00D7  30	HALT
00D8  7E	RETI		; reserved
00D9  30	HALT
00DA  30	HALT
00DB  30	HALT
00DC  7E	RETI		; reserved
00DD  30	HALT
00DE  30	HALT
00DF  30	HALT
00E0  7E	RETI		; sleep timer
00E1  30	HALT
00E2  30	HALT
00E3  30	HALT

__Start:
00E4  82 1B	JMP	0x0300
00E6  30	HALT
00E7  30	HALT
00E8  30	HALT
00E9  30	HALT
00EA  30	HALT
00EB  30	HALT
00EC  30	HALT
00ED  30	HALT
00EE  30	HALT
00EF  30	HALT
00F0  30	HALT
00F1  30	HALT
00F2  30	HALT
00F3  30	HALT
00F4  30	HALT
00F5  30	HALT
00F6  30	HALT
00F7  30	HALT
00F8  30	HALT
00F9  30	HALT
00FA  30	HALT
00FB  30	HALT
00FC  30	HALT
00FD  30	HALT
00FE  30	HALT
00FF  30	HALT
0100  01 06	ADD	A,0x06
0102  01 61	ADD	A,0x61
0104  01 E1	ADD	A,0xE1
0106  01 01	ADD	A,0x01
0108  0B 01	ADC	A,[X+0x01]
010A  58 01	MOV	X,[0x01]
010C  01 16	ADD	A,0x16
010E  01 10	ADD	A,0x10
0110  01 18	ADD	A,0x18
0112  01 2D	ADD	A,0x2D
0114  01 1C	ADD	A,0x1C
0116  80 80	JMP	0x0197
0118  01 3E	ADD	A,0x3E
011A  01 4B	ADD	A,0x4B
011C  01 00	ADD	A,0x00
011E  00	SSC
011F  09 01	ADC	A,0x01
0121  8E 00	JMP	0xFF22
0123  00	SSC
0124  DE 00	JNC	0xFF25
0126  00	SSC
0127  09 01	ADC	A,0x01
0129  A7 00	JZ	0x082A
012B  00	SSC
012C  DE 01	JNC	0xFF2E
012E  00	SSC
012F  00	SSC
0130  2A 01	OR	A,[0x01]
0132  B7 00	JNZ	0x0833
0134  00	SSC
0135  DE 00	JNC	0xFF36
0137  00	SSC
0138  2A 01	OR	A,[0x01]
013A  B7 00	JNZ	0x083B
013C  00	SSC
013D  DE 04	JNC	0xFF42
013F  02 40	ADD	A,[0x40]
0141  00	SSC
0142  00	SSC
0143  02 41	ADD	A,[0x41]
0145  00	SSC
0146  00	SSC
0147  02 42	ADD	A,[0x42]
0149  00	SSC
014A  00	SSC
014B  04 02	ADD	[0x02],A
014D  C3 00	JC	0x044E
014F  00	SSC
0150  02 C4	ADD	A,[0xC4]
0152  00	SSC
0153  00	SSC
0154  02 C5	ADD	A,[0xC5]
0156  00	SSC
0157  00	SSC
0158  00	SSC
0159  00	SSC
015A  00	SSC
015B  3B 01	CMP	A,[X+0x01]
015D  7C 00 00	LCALL	0x0000	; reset
0160  DE 00	JNC	0xFF61
0162  00	SSC
0163  00	SSC
0164  12 01	SUB	A,[0x01]
0166  6A	RLC	A
0167  00	SSC
0168  00	SSC
0169  DE 12	JNC	0xFF7C
016B  01 00	ADD	A,0x00
016D  02 00	ADD	A,[0x00]
016F  00	SSC
0170  00	SSC
0171  08	PUSH	A

usb_vendor_id:
0172  AC 05

usb_product_id:
0174  41 82

0176  44
0177  02 01	ADD	A,[0x01]
0179  02 00	ADD	A,[0x00]
017B  01 09	ADD	A,0x09
017D  02 3B	ADD	A,[0x3B]
017F  00	SSC
0180  02 01	ADD	A,[0x01]
0182  01 A0	ADD	A,0xA0
0184  32 09	XOR	A,[0x09]
0186  04 00	ADD	[0x00],A
0188  00	SSC
0189  01 03	ADD	A,0x03
018B  00	SSC
018C  00	SSC
018D  00	SSC
018E  09 21	ADC	A,0x21
0190  11 01	SUB	A,0x01
0192  00	SSC
0193  01 22	ADD	A,0x22
0195  2A 00	OR	A,[0x00]
0197  07 05 82	ADD	[X+0x05],0x82
019A  03 08	ADD	A,[X+0x08]
019C  00	SSC
019D  0A 09	ADC	A,[0x09]
019F  04 01	ADD	[0x01],A
01A1  00	SSC
01A2  01 FF	ADD	A,0xFF
01A4  00	SSC
01A5  00	SSC
01A6  00	SSC
01A7  09 21	ADC	A,0x21
01A9  11 01	SUB	A,0x01
01AB  00	SSC
01AC  01 22	ADD	A,0x22
01AE  2A 00	OR	A,[0x00]
01B0  07 05 81	ADD	[X+0x05],0x81
01B3  03 08	ADD	A,[X+0x08]
01B5  00	SSC
01B6  0A 05	ADC	A,[0x05]

hid_descriptor_data:
01B7  05
...
01E0  0C

01E1  02
01E2  00	SSC
01E3  00	SSC
01E4  04 01	ADD	[0x01],A
01E6  FA 00	INDEX	0xFBE8
01E8  00	SSC
01E9  DE 00	JNC	0xFFEA
01EB  00	SSC
01EC  2A 01	OR	A,[0x01]
01EE  FE 00	INDEX	0xFFF0
01F0  00	SSC
01F1  DE 00	JNC	0xFFF2
01F3  00	SSC
01F4  18	POP	A
01F5  02 28	ADD	A,[0x28]
01F7  00	SSC
01F8  00	SSC
01F9  DE 04	JNC	0xFFFE
01FB  03 09	ADD	A,[X+0x09]
01FD  04 2A	ADD	[0x2A],A
01FF  03

Apple_Computer_Inc:
0200  41
...
0227  00

IR_Receiver:
022A  49
...
023F  00

0240  FF FF	INDEX	0x0241
0242  0F 01 00	ADC	[X+0x01],0x00
0245  02 00	ADD	A,[0x00]
0247  7B 00	DEC	[X+0x00]
0249  9A DE	CALL	0xFD29
024B  01 00	ADD	A,0x00
024D  02 00	ADD	A,[0x00]
024F  88 00	JMP	0xFA50
0251  00	SSC
0252  DE 01	JNC	0x0054
0254  00	SSC
0255  01 00	ADD	A,0x00
0257  7F	RET
0258  00	SSC
0259  00	SSC
025A  DE 01	JNC	0x005C
025C  00	SSC
025D  01 00	ADD	A,0x00
025F  7F	RET
0260  00	SSC
0261  00	SSC
0262  DE 01	JNC	0x0064
0264  00	SSC
0265  01 00	ADD	A,0x00
0267  7F	RET
0268  00	SSC
0269  00	SSC
026A  DE 01	JNC	0x006C
026C  00	SSC
026D  03 00	ADD	A,[X+0x00]
026F  8A 00	JMP	0xFC70
0271  00	SSC
0272  DE 01	JNC	0x0074
0274  00	SSC
0275  02 00	ADD	A,[0x00]
0277  8D 00	JMP	0xFF78
0279  00	SSC
027A  DE 01	JNC	0x007C
027C  00	SSC
027D  02 00	ADD	A,[0x00]
027F  8F 00	JMP	0x0180
0281  00	SSC
0282  DE 01	JNC	0x0084
0284  00	SSC
0285  02 00	ADD	A,[0x00]
0287  91 00	CALL	0x0389
0289  00	SSC
028A  DE 01	JNC	0x008C
028C  00	SSC
028D  02 00	ADD	A,[0x00]
028F  93 00	CALL	0x0591
0291  00	SSC
0292  DE 01	JNC	0x0094
0294  00	SSC
0295  01 00	ADD	A,0x00
0297  7F	RET
0298  00	SSC
0299  00	SSC
029A  DE 01	JNC	0x009C
029C  00	SSC
029D  02 00	ADD	A,[0x00]
029F  95 00	CALL	0x07A1
02A1  00	SSC
02A2  DE 01	JNC	0x00A4
02A4  00	SSC
02A5  01 00	ADD	A,0x00
02A7  7F	RET
02A8  00	SSC
02A9  00	SSC
02AA  DE 01	JNC	0x00AC
02AC  00	SSC
02AD  03 00	ADD	A,[X+0x00]
02AF  7F	RET
02B0  00	SSC
02B1  00	SSC
02B2  DE 01	JNC	0x00B4
02B4  00	SSC
02B5  02 00	ADD	A,[0x00]
02B7  7D 00 9D	LJMP	0x009D
02BA  DE 01	JNC	0x00BC
02BC  00	SSC
02BD  02 00	ADD	A,[0x00]
02BF  7F	RET
02C0  00	SSC
02C1  00	SSC
02C2  DE FF	JNC	0x01C2
02C4  FF 02	INDEX	0x01C8
02C6  01 00	ADD	A,0x00
02C8  03 00	ADD	A,[X+0x00]
02CA  00	SSC
02CB  00	SSC
02CC  00	SSC
02CD  DE 01	JNC	0x00CF
02CF  00	SSC
02D0  03 00	ADD	A,[X+0x00]
02D2  82 00	JMP	0x04D3
02D4  97 DE	CALL	0x0AB4
02D6  01 00	ADD	A,0x00
02D8  03 00	ADD	A,[X+0x00]
02DA  85 00	JMP	0x07DB
02DC  00	SSC
02DD  DE 30	JNC	0x010E
02DF  30	HALT
02E0  30	HALT
02E1  30	HALT
02E2  30	HALT
02E3  30	HALT
02E4  30	HALT
02E5  30	HALT
02E6  30	HALT
02E7  30	HALT
02E8  30	HALT
02E9  30	HALT
02EA  30	HALT
02EB  30	HALT
02EC  30	HALT
02ED  30	HALT
02EE  30	HALT
02EF  30	HALT
02F0  30	HALT
02F1  30	HALT
02F2  30	HALT
02F3  30	HALT
02F4  30	HALT
02F5  30	HALT
02F6  30	HALT
02F7  30	HALT
02F8  30	HALT
02F9  30	HALT
02FA  30	HALT
02FB  30	HALT
02FC  30	HALT
02FD  30	HALT
02FE  30	HALT
02FF  30	HALT

start:
0300  43 32 00	OR	REG[0x32],0x00
0303  55 F8 00	MOV	[0xF8],0x00
0306  55 F9 00	MOV	[0xF9],0x00
0309  50 A0	MOV	A,0xA0	; setup stack
030B  4E	SWAP	A,SP
030C  7C 03 90	LCALL	0x0390 	; func1
030F  90 08	CALL	0x0319	; func0
0311  62 E2 00	MOV	REG[0xE2],0x00 ; INT_VC
0314  7C 08 60	LCALL	0x0860	; func2
0317  8F FF	JMP	0x0317 	; forever

func0:
0319  50 00	MOV	A,0x00
031B  55 57 59	MOV	[0x57],0x59
031E  3C 57 A0	CMP	[0x57],0xA0
0321  A0 05	JZ	0x0327
0323  3F 57	MVI	[[0x57]++],A
0325  8F F8	JMP	0x031E
0327  50 03	MOV	A,0x03
0329  57 77	MOV	X,0x77
032B  55 57 30	MOV	[0x57],0x30
032E  3C 57 49	CMP	[0x57],0x49
0331  A0 0B	JZ	0x033D
0333  08	PUSH	A
0334  28	ROMX
0335  3F 57	MVI	[[0x57]++],A
0337  18	POP	A
0338  75	INC	X
0339  09 00	ADC	A,0x00
033B  8F F2	JMP	0x032E
033D  7F	RET

033E  30	HALT
033F  30	HALT

dummy:
0340  7F	RET

0341  32 00	XOR	A,[0x00]
0343  30	HALT
0344  00	SSC
0345  05 01	ADD	[X+0x01],A
0347  06 01 07	ADD	[0x01],0x07
034A  10	PUSH	X
034B  08	PUSH	A
034C  01 09	ADD	A,0x09
034E  01 0A	ADD	A,0x0A
0350  70 0B	AND	F,0x0B
0352  01 0C	ADD	A,0x0C
0354  00	SSC
0355  0D 01	ADC	[X+0x01],A
0357  0E 01 0F	ADC	[0x01],0x0F
035A  01 10	ADD	A,0x10
035C  11 11	SUB	A,0x11
035E  11 12	SUB	A,0x12
0360  60 13	MOV	REG[0x13],A
0362  00	SSC
0363  14 00	SUB	[0x00],A
0365  15 00	SUB	[X+0x00],A
0367  16 00 3D	SUB	[0x00],0x3D
036A  00	SSC
036B  2B 00	OR	A,[X+0x00]
036D  31 40	XOR	A,0x40
036F  2A 00	OR	A,[0x00]
0371  73	CPL	A
0372  01 FF	ADD	A,0xFF
0374  E3 15	JACC	0x068A
0376  FF 02	INDEX	0x027A
0378  FF 00	INDEX	0x027A
037A  00	SSC
037B  00	SSC
037C  00	SSC
037D  00	SSC
037E  00	SSC
037F  00	SSC
0380  00	SSC
0381  00	SSC
0382  00	SSC
0383  00	SSC
0384  00	SSC
0385  00	SSC
0386  00	SSC
0387  00	SSC
0388  00	SSC
0389  02 00	ADD	A,[0x00]
038B  00	SSC
038C  00	SSC
038D  00	SSC
038E  00	SSC
038F  00	SSC

func1:
0390  55 58 00	MOV	[0x58],0x00
0393  7C 03 40	LCALL	0x0340 	; dummy
0396  7C 03 9A	LCALL	0x039A	; func3
0399  7F	RET

func3:
039A  10	PUSH	X
039B  70 EF	AND	F,0xEF
039D  50 00	MOV	A,0x00
039F  67	ASR	A
03A0  50 03	MOV	A,0x03
03A2  57 41	MOV	X,0x41
03A4  7C 03 B5	LCALL	0x03B5 	; func4
03A7  50 01	MOV	A,0x01
03A9  67	ASR	A
03AA  50 03	MOV	A,0x03
03AC  57 74	MOV	X,0x74
03AE  7C 03 B5	LCALL	0x03B5 	; func4
03B1  70 EF	AND	F,0xEF
03B3  20	POP	X
03B4  7F	RET

func4:
03B5  38 02	ADD	SP,0x02
03B7  10	PUSH	X
03B8  08	PUSH	A
03B9  4F	MOV	X,SP
03BA  56 FC 00	MOV	[X+0xFC],0x00
03BD  D0 04	JNC	0x03C2
03BF  56 FC 01	MOV	[X+0xFC],0x01
03C2  18	POP	A
03C3  20	POP	X
03C4  70 EF	AND	F,0xEF
03C6  62 E3 00	MOV	REG[0xE3],0x00
03C9  10	PUSH	X
03CA  08	PUSH	A
03CB  28	ROMX
03CC  39 FF	CMP	A,0xFF
03CE  A0 1F	JZ	0x03EE
03D0  4F	MOV	X,SP
03D1  48 FC 01	TST	[X+0xFC],0x01
03D4  A0 03	JZ	0x03D8
03D6  71 10	OR	F,0x10
03D8  54 FD	MOV	[X+0xFD],A
03DA  18	POP	A
03DB  20	POP	X
03DC  75	INC	X
03DD  09 00	ADC	A,0x00
03DF  10	PUSH	X
03E0  08	PUSH	A
03E1  28	ROMX
03E2  4F	MOV	X,SP
03E3  59 FD	MOV	X,[X+0xFD]
03E5  61 00	MOV	REG[X+0x00],A
03E7  18	POP	A
03E8  20	POP	X
03E9  75	INC	X
03EA  09 00	ADC	A,0x00
03EC  8F D7	JMP	0x03C4
03EE  38 FC	ADD	SP,0xFC
03F0  7F	RET

enable_timer1_int:
03F1  43 E1 20	OR	REG[0xE1],0x20 ; INT_MSK1, enable timer1 int
03F4  7F	RET

disable_timer1_int:
03F5  41 E1 DF	AND	REG[0xE1],0xDF
03F8  7F	RET

dummy2:
03F9  7F	RET

disable_timer1_int_b:
03FA  41 E1 DF	AND	REG[0xE1],0xDF
03FD  7F	RET

int0_handler:
03FE  7E	RETI

int1_handler:
03FF  7E	RETI

int2_handler:
0400  7E	RETI

gpio0_handler:
0401  7E	RETI

gpio1_handler:
0402  7D 0A 4B	LJMP	0x0A4B 	; handle_gpio1

0405  7E	RETI

gpio2_handler:
0406  7E	RETI

gpio3_handler:
0407  7E	RETI

unused1:
0408  55 30 02	MOV	[0x30],0x02
040B  7F	RET

func60:
040C  10	PUSH	X
040D  4F	MOV	X,SP
040E  38 06	ADD	SP,0x06
0410  62 E3 00	MOV	REG[0xE3],0x00
0413  51 30	MOV	A,[0x30]
0415  54 01	MOV	[X+0x01],A
0417  56 00 00	MOV	[X+0x00],0x00
041A  3D 00 00	CMP	[X+0x00],0x00
041D  B0 06	JNZ	0x0424
041F  3D 01 00	CMP	[X+0x01],0x00
0422  A0 3F	JZ	0x0462
0424  3D 00 00	CMP	[X+0x00],0x00
0427  B0 06	JNZ	0x042E
0429  3D 01 01	CMP	[X+0x01],0x01
042C  A1 75	JZ	0x05A2
042E  3D 00 00	CMP	[X+0x00],0x00
0431  B0 06	JNZ	0x0438
0433  3D 01 02	CMP	[X+0x01],0x02
0436  A1 8C	JZ	0x05C3
0438  3D 00 00	CMP	[X+0x00],0x00
043B  B0 06	JNZ	0x0442
043D  3D 01 03	CMP	[X+0x01],0x03
0440  A1 F3	JZ	0x0634
0442  3D 00 00	CMP	[X+0x00],0x00
0445  B0 06	JNZ	0x044C
0447  3D 01 04	CMP	[X+0x01],0x04
044A  A2 16	JZ	0x0661
044C  3D 00 00	CMP	[X+0x00],0x00
044F  B0 06	JNZ	0x0456
0451  3D 01 05	CMP	[X+0x01],0x05
0454  A2 46	JZ	0x069B
0456  3D 00 00	CMP	[X+0x00],0x00
0459  B0 06	JNZ	0x0460
045B  3D 01 06	CMP	[X+0x01],0x06
045E  A2 87	JZ	0x06E6
0460  82 8A	JMP	0x06EB
0462  52 FC	MOV	A,[X+0xFC]
0464  11 08	SUB	A,0x08
0466  52 FB	MOV	A,[X+0xFB]
0468  19 00	SBB	A,0x00
046A  C0 15	JC	0x0480
046C  50 10	MOV	A,0x10
046E  13 FC	SUB	A,[X+0xFC]
0470  50 00	MOV	A,0x00
0472  1B FB	SBB	A,[X+0xFB]
0474  C0 0B	JC	0x0480
0476  65 5C	ASL	[0x5C]
0478  6B 5B	RLC	[0x5B]
047A  6B 5A	RLC	[0x5A]
047C  6B 59	RLC	[0x59]
047E  80 45	JMP	0x04C4
0480  52 FC	MOV	A,[X+0xFC]
0482  11 20	SUB	A,0x20
0484  52 FB	MOV	A,[X+0xFB]
0486  19 00	SBB	A,0x00
0488  C0 33	JC	0x04BC
048A  50 2E	MOV	A,0x2E
048C  13 FC	SUB	A,[X+0xFC]
048E  50 00	MOV	A,0x00
0490  1B FB	SBB	A,[X+0xFB]
0492  C0 29	JC	0x04BC
0494  5F 57 59	MOV	[0x57],[0x59]
0497  5F 56 5A	MOV	[0x56],[0x5A]
049A  5F 55 5B	MOV	[0x55],[0x5B]
049D  5F 54 5C	MOV	[0x54],[0x5C]
04A0  65 54	ASL	[0x54]
04A2  6B 55	RLC	[0x55]
04A4  6B 56	RLC	[0x56]
04A6  6B 57	RLC	[0x57]
04A8  51 54	MOV	A,[0x54]
04AA  29 01	OR	A,0x01
04AC  53 5C	MOV	[0x5C],A
04AE  51 55	MOV	A,[0x55]
04B0  53 5B	MOV	[0x5B],A
04B2  51 56	MOV	A,[0x56]
04B4  53 5A	MOV	[0x5A],A
04B6  51 57	MOV	A,[0x57]
04B8  53 59	MOV	[0x59],A
04BA  80 09	JMP	0x04C4
04BC  55 30 06	MOV	[0x30],0x06
04BF  55 31 FF	MOV	[0x31],0xFF
04C2  82 2B	JMP	0x06EE
04C4  76 32	INC	[0x32]
04C6  3C 32 20	CMP	[0x32],0x20
04C9  C0 D3	JC	0x059D
04CB  5F 57 59	MOV	[0x57],[0x59]
04CE  5F 56 5A	MOV	[0x56],[0x5A]
04D1  5F 55 5B	MOV	[0x55],[0x5B]
04D4  5F 54 5C	MOV	[0x54],[0x5C]
04D7  50 10	MOV	A,0x10
04D9  68 57	ASR	[0x57]
04DB  6E 56	RRC	[0x56]
04DD  6E 55	RRC	[0x55]
04DF  6E 54	RRC	[0x54]
04E1  78	DEC	A
04E2  BF F6	JNZ	0x04D9
04E4  51 55	MOV	A,[0x55]
04E6  08	PUSH	A
04E7  51 54	MOV	A,[0x54]
04E9  08	PUSH	A
04EA  7C 10 33	LCALL	0x1033	; func11
04ED  51 56	MOV	A,[0x56]
04EF  54 03	MOV	[X+0x03],A
04F1  51 57	MOV	A,[0x57]
04F3  54 02	MOV	[X+0x02],A
04F5  51 5C	MOV	A,[0x5C]
04F7  53 54	MOV	[0x54],A
04F9  51 5B	MOV	A,[0x5B]
04FB  08	PUSH	A
04FC  51 54	MOV	A,[0x54]
04FE  08	PUSH	A
04FF  7C 10 33	LCALL	0x1033	; func11
0502  38 FC	ADD	SP,0xFC
0504  51 56	MOV	A,[0x56]
0506  54 05	MOV	[X+0x05],A
0508  51 57	MOV	A,[0x57]
050A  54 04	MOV	[X+0x04],A
050C  52 03	MOV	A,[X+0x03]
050E  53 5C	MOV	[0x5C],A
0510  52 02	MOV	A,[X+0x02]
0512  53 5B	MOV	[0x5B],A
0514  55 5A 00	MOV	[0x5A],0x00
0517  55 59 00	MOV	[0x59],0x00
051A  52 05	MOV	A,[X+0x05]
051C  53 54	MOV	[0x54],A
051E  52 04	MOV	A,[X+0x04]
0520  53 55	MOV	[0x55],A
0522  55 56 00	MOV	[0x56],0x00
0525  55 57 00	MOV	[0x57],0x00
0528  5F 53 59	MOV	[0x53],[0x59]
052B  5F 52 5A	MOV	[0x52],[0x5A]
052E  5F 51 5B	MOV	[0x51],[0x5B]
0531  5F 50 5C	MOV	[0x50],[0x5C]
0534  50 10	MOV	A,0x10
0536  65 50	ASL	[0x50]
0538  6B 51	RLC	[0x51]
053A  6B 52	RLC	[0x52]
053C  6B 53	RLC	[0x53]
053E  78	DEC	A
053F  BF F6	JNZ	0x0536
0541  51 50	MOV	A,[0x50]
0543  2A 54	OR	A,[0x54]
0545  53 5C	MOV	[0x5C],A
0547  51 51	MOV	A,[0x51]
0549  2A 55	OR	A,[0x55]
054B  53 5B	MOV	[0x5B],A
054D  51 52	MOV	A,[0x52]
054F  2A 56	OR	A,[0x56]
0551  53 5A	MOV	[0x5A],A
0553  51 53	MOV	A,[0x53]
0555  2A 57	OR	A,[0x57]
0557  53 59	MOV	[0x59],A
0559  51 59	MOV	A,[0x59]
055B  08	PUSH	A
055C  51 5A	MOV	A,[0x5A]
055E  08	PUSH	A
055F  51 5B	MOV	A,[0x5B]
0561  08	PUSH	A
0562  51 5C	MOV	A,[0x5C]
0564  08	PUSH	A
0565  7C 10 9A	LCALL	0x109A	; func13
0568  38 FC	ADD	SP,0xFC
056A  39 00	CMP	A,0x00
056C  A0 28	JZ	0x0595
056E  62 E3 00	MOV	REG[0xE3],0x00
0571  51 59	MOV	A,[0x59]
0573  08	PUSH	A
0574  51 5A	MOV	A,[0x5A]
0576  08	PUSH	A
0577  51 5B	MOV	A,[0x5B]
0579  08	PUSH	A
057A  51 5C	MOV	A,[0x5C]
057C  08	PUSH	A
057D  50 25	MOV	A,0x25
057F  08	PUSH	A
0580  91 70	CALL	0x06F2	; func50
0582  38 FB	ADD	SP,0xFB
0584  5F 33 59	MOV	[0x33],[0x59]
0587  5F 34 5A	MOV	[0x34],[0x5A]
058A  5F 35 5B	MOV	[0x35],[0x5B]
058D  5F 36 5C	MOV	[0x36],[0x5C]
0590  55 31 FE	MOV	[0x31],0xFE
0593  80 04	JMP	0x0598
0595  55 31 FF	MOV	[0x31],0xFF
0598  55 30 02	MOV	[0x30],0x02
059B  81 52	JMP	0x06EE
059D  55 30 01	MOV	[0x30],0x01
05A0  81 4D	JMP	0x06EE
05A2  52 FC	MOV	A,[X+0xFC]
05A4  11 0C	SUB	A,0x0C
05A6  52 FB	MOV	A,[X+0xFB]
05A8  19 00	SBB	A,0x00
05AA  C0 10	JC	0x05BB
05AC  50 1C	MOV	A,0x1C
05AE  13 FC	SUB	A,[X+0xFC]
05B0  50 00	MOV	A,0x00
05B2  1B FB	SBB	A,[X+0xFB]
05B4  C0 06	JC	0x05BB
05B6  55 30 00	MOV	[0x30],0x00
05B9  81 34	JMP	0x06EE
05BB  55 30 02	MOV	[0x30],0x02
05BE  55 31 FF	MOV	[0x31],0xFF
05C1  81 2C	JMP	0x06EE
05C3  49 00 20	TST	REG[0x00],0x20 ; P0DATA
05C6  B1 27	JNZ	0x06EE
05C8  55 32 00	MOV	[0x32],0x00
05CB  55 59 00	MOV	[0x59],0x00
05CE  55 5A 00	MOV	[0x5A],0x00
05D1  55 5B 00	MOV	[0x5B],0x00
05D4  55 5C 00	MOV	[0x5C],0x00
05D7  3C 31 FD	CMP	[0x31],0xFD
05DA  B0 0D	JNZ	0x05E8
05DC  55 59 00	MOV	[0x59],0x00
05DF  55 5A 00	MOV	[0x5A],0x00
05E2  55 5B 00	MOV	[0x5B],0x00
05E5  55 5C 00	MOV	[0x5C],0x00
05E8  3C 31 FD	CMP	[0x31],0xFD
05EB  B0 09	JNZ	0x05F5
05ED  52 FC	MOV	A,[X+0xFC]
05EF  53 3A	MOV	[0x3A],A
05F1  52 FB	MOV	A,[X+0xFB]
05F3  53 39	MOV	[0x39],A
05F5  52 FC	MOV	A,[X+0xFC]
05F7  11 C8	SUB	A,0xC8
05F9  52 FB	MOV	A,[X+0xFB]
05FB  19 07	SBB	A,0x07
05FD  C0 15	JC	0x0613
05FF  50 88	MOV	A,0x88
0601  13 FC	SUB	A,[X+0xFC]
0603  50 0A	MOV	A,0x0A
0605  1B FB	SBB	A,[X+0xFB]
0607  C0 0B	JC	0x0613
0609  3C 31 FD	CMP	[0x31],0xFD
060C  B0 06	JNZ	0x0613
060E  55 31 FC	MOV	[0x31],0xFC
0611  80 1D	JMP	0x062F
0613  52 FC	MOV	A,[X+0xFC]
0615  11 1C	SUB	A,0x1C
0617  52 FB	MOV	A,[X+0xFB]
0619  19 03	SBB	A,0x03
061B  C0 13	JC	0x062F
061D  50 38	MOV	A,0x38
061F  13 FC	SUB	A,[X+0xFC]
0621  50 04	MOV	A,0x04
0623  1B FB	SBB	A,[X+0xFB]
0625  C0 09	JC	0x062F
0627  3C 31 FE	CMP	[0x31],0xFE
062A  B0 04	JNZ	0x062F
062C  55 31 FC	MOV	[0x31],0xFC
062F  55 30 03	MOV	[0x30],0x03
0632  80 BB	JMP	0x06EE
0634  52 FC	MOV	A,[X+0xFC]
0636  53 3C	MOV	[0x3C],A
0638  52 FB	MOV	A,[X+0xFB]
063A  53 3B	MOV	[0x3B],A
063C  50 00	MOV	A,0x00
063E  08	PUSH	A
063F  50 F4	MOV	A,0xF4
0641  08	PUSH	A
0642  50 00	MOV	A,0x00
0644  08	PUSH	A
0645  50 B2	MOV	A,0xB2
0647  08	PUSH	A
0648  52 FB	MOV	A,[X+0xFB]
064A  08	PUSH	A
064B  52 FC	MOV	A,[X+0xFC]
064D  08	PUSH	A
064E  7C 10 7C	LCALL	0x107C	; func12
0651  38 FA	ADD	SP,0xFA
0653  39 00	CMP	A,0x00
0655  A0 06	JZ	0x065C
0657  55 30 04	MOV	[0x30],0x04
065A  80 93	JMP	0x06EE
065C  55 30 02	MOV	[0x30],0x02
065F  80 8E	JMP	0x06EE
0661  52 FC	MOV	A,[X+0xFC]
0663  11 58	SUB	A,0x58
0665  52 FB	MOV	A,[X+0xFB]
0667  19 00	SBB	A,0x00
0669  C0 10	JC	0x067A
066B  50 7A	MOV	A,0x7A
066D  13 FC	SUB	A,[X+0xFC]
066F  50 00	MOV	A,0x00
0671  1B FB	SBB	A,[X+0xFB]
0673  C0 06	JC	0x067A
0675  55 30 01	MOV	[0x30],0x01
0678  80 75	JMP	0x06EE
067A  52 FC	MOV	A,[X+0xFC]
067C  11 2C	SUB	A,0x2C
067E  52 FB	MOV	A,[X+0xFB]
0680  19 00	SBB	A,0x00
0682  C0 10	JC	0x0693
0684  50 3E	MOV	A,0x3E
0686  13 FC	SUB	A,[X+0xFC]
0688  50 00	MOV	A,0x00
068A  1B FB	SBB	A,[X+0xFB]
068C  C0 06	JC	0x0693
068E  55 30 05	MOV	[0x30],0x05
0691  80 5C	JMP	0x06EE
0693  55 30 06	MOV	[0x30],0x06
0696  55 31 FF	MOV	[0x31],0xFF
0699  80 54	JMP	0x06EE
069B  52 FC	MOV	A,[X+0xFC]
069D  11 0C	SUB	A,0x0C
069F  52 FB	MOV	A,[X+0xFB]
06A1  19 00	SBB	A,0x00
06A3  C0 3A	JC	0x06DE
06A5  50 1C	MOV	A,0x1C
06A7  13 FC	SUB	A,[X+0xFC]
06A9  50 00	MOV	A,0x00
06AB  1B FB	SBB	A,[X+0xFB]
06AD  C0 30	JC	0x06DE
06AF  3C 31 FC	CMP	[0x31],0xFC
06B2  B0 19	JNZ	0x06CC
06B4  51 33	MOV	A,[0x33]
06B6  08	PUSH	A
06B7  51 34	MOV	A,[0x34]
06B9  08	PUSH	A
06BA  51 35	MOV	A,[0x35]
06BC  08	PUSH	A
06BD  51 36	MOV	A,[0x36]
06BF  08	PUSH	A
06C0  50 26	MOV	A,0x26
06C2  08	PUSH	A
06C3  90 2D	CALL	0x06F2	; func50
06C5  38 FB	ADD	SP,0xFB
06C7  55 31 FD	MOV	[0x31],0xFD
06CA  80 16	JMP	0x06E1
06CC  50 00	MOV	A,0x00
06CE  08	PUSH	A
06CF  08	PUSH	A
06D0  08	PUSH	A
06D1  08	PUSH	A
06D2  50 26	MOV	A,0x26
06D4  08	PUSH	A
06D5  90 1B	CALL	0x06F2	; func50
06D7  38 FB	ADD	SP,0xFB
06D9  55 31 FF	MOV	[0x31],0xFF
06DC  80 04	JMP	0x06E1
06DE  55 31 FF	MOV	[0x31],0xFF
06E1  55 30 02	MOV	[0x30],0x02
06E4  80 09	JMP	0x06EE
06E6  55 30 02	MOV	[0x30],0x02
06E9  80 04	JMP	0x06EE
06EB  55 30 02	MOV	[0x30],0x02
06EE  38 FA	ADD	SP,0xFA
06F0  20	POP	X
06F1  7F	RET

func50:
06F2  10	PUSH	X
06F3  4F	MOV	X,SP
06F4  3D FC 26	CMP	[X+0xFC],0x26
06F7  B0 1C	JNZ	0x0714
06F9  3C 41 06	CMP	[0x41],0x06
06FC  D1 61	JNC	0x085E
06FE  52 F8	MOV	A,[X+0xF8]
0700  08	PUSH	A
0701  52 F9	MOV	A,[X+0xF9]
0703  08	PUSH	A
0704  52 FA	MOV	A,[X+0xFA]
0706  08	PUSH	A
0707  52 FB	MOV	A,[X+0xFB]
0709  08	PUSH	A
070A  50 26	MOV	A,0x26
070C  08	PUSH	A
070D  7C 0E 87	LCALL	0x0E87	; func23
0710  38 FB	ADD	SP,0xFB
0712  81 4B	JMP	0x085E
0714  3C 37 00	CMP	[0x37],0x00
0717  A0 5F	JZ	0x0777
0719  3D FC 25	CMP	[X+0xFC],0x25
071C  B0 5A	JNZ	0x0777
071E  55 54 00	MOV	[0x54],0x00
0721  55 55 00	MOV	[0x55],0x00
0724  52 F9	MOV	A,[X+0xF9]
0726  21 E0	AND	A,0xE0
0728  53 56	MOV	[0x56],A
072A  52 F8	MOV	A,[X+0xF8]
072C  39 87	CMP	A,0x87
072E  B0 48	JNZ	0x0777
0730  3C 56 E0	CMP	[0x56],0xE0
0733  B0 43	JNZ	0x0777
0735  3C 55 00	CMP	[0x55],0x00
0738  B0 3E	JNZ	0x0777
073A  3C 54 00	CMP	[0x54],0x00
073D  B0 39	JNZ	0x0777
073F  55 60 00	MOV	[0x60],0x00
0742  52 FA	MOV	A,[X+0xFA]
0744  53 5F	MOV	[0x5F],A
0746  55 5E 00	MOV	[0x5E],0x00
0749  55 5D 00	MOV	[0x5D],0x00
074C  55 8B 00	MOV	[0x8B],0x00
074F  5F 57 5D	MOV	[0x57],[0x5D]
0752  5F 56 5E	MOV	[0x56],[0x5E]
0755  5F 55 5F	MOV	[0x55],[0x5F]
0758  5F 54 60	MOV	[0x54],[0x60]
075B  50 08	MOV	A,0x08
075D  68 57	ASR	[0x57]
075F  6E 56	RRC	[0x56]
0761  6E 55	RRC	[0x55]
0763  6E 54	RRC	[0x54]
0765  78	DEC	A
0766  BF F6	JNZ	0x075D
0768  26 55 00	AND	[0x55],0x00
076B  26 56 00	AND	[0x56],0x00
076E  26 57 00	AND	[0x57],0x00
0771  5F 8C 54	MOV	[0x8C],[0x54]
0774  55 37 00	MOV	[0x37],0x00
0777  55 54 00	MOV	[0x54],0x00
077A  55 55 00	MOV	[0x55],0x00
077D  52 F9	MOV	A,[X+0xF9]
077F  21 E0	AND	A,0xE0
0781  53 56	MOV	[0x56],A
0783  52 F8	MOV	A,[X+0xF8]
0785  39 87	CMP	A,0x87
0787  B0 10	JNZ	0x0798
0789  3C 56 E0	CMP	[0x56],0xE0
078C  B0 0B	JNZ	0x0798
078E  3C 55 00	CMP	[0x55],0x00
0791  B0 06	JNZ	0x0798
0793  3C 54 00	CMP	[0x54],0x00
0796  A0 1E	JZ	0x07B5
0798  3C 8E 01	CMP	[0x8E],0x01
079B  B0 03	JNZ	0x079F
079D  80 C0	JMP	0x085E
079F  52 F8	MOV	A,[X+0xF8]
07A1  08	PUSH	A
07A2  52 F9	MOV	A,[X+0xF9]
07A4  08	PUSH	A
07A5  52 FA	MOV	A,[X+0xFA]
07A7  08	PUSH	A
07A8  52 FB	MOV	A,[X+0xFB]
07AA  08	PUSH	A
07AB  50 25	MOV	A,0x25
07AD  08	PUSH	A
07AE  7C 0E 87	LCALL	0x0E87	; func23
07B1  38 FB	ADD	SP,0xFB
07B3  80 AA	JMP	0x085E
07B5  3C 90 01	CMP	[0x90],0x01
07B8  A0 06	JZ	0x07BF
07BA  3C 41 00	CMP	[0x41],0x00
07BD  A0 31	JZ	0x07EF
07BF  3C 5D FF	CMP	[0x5D],0xFF
07C2  B0 10	JNZ	0x07D3
07C4  3C 5E FF	CMP	[0x5E],0xFF
07C7  B0 0B	JNZ	0x07D3
07C9  3C 5F FF	CMP	[0x5F],0xFF
07CC  B0 06	JNZ	0x07D3
07CE  3C 60 FF	CMP	[0x60],0xFF
07D1  A0 1D	JZ	0x07EF
07D3  52 FA	MOV	A,[X+0xFA]
07D5  53 55	MOV	[0x55],A
07D7  50 00	MOV	A,0x00
07D9  3A 5D	CMP	A,[0x5D]
07DB  B0 11	JNZ	0x07ED
07DD  3A 5E	CMP	A,[0x5E]
07DF  B0 0D	JNZ	0x07ED
07E1  51 55	MOV	A,[0x55]
07E3  3A 5F	CMP	A,[0x5F]
07E5  B0 07	JNZ	0x07ED
07E7  50 00	MOV	A,0x00
07E9  3A 60	CMP	A,[0x60]
07EB  A0 03	JZ	0x07EF
07ED  80 70	JMP	0x085E
07EF  3C 5D FF	CMP	[0x5D],0xFF
07F2  B0 10	JNZ	0x0803
07F4  3C 5E FF	CMP	[0x5E],0xFF
07F7  B0 0B	JNZ	0x0803
07F9  3C 5F FF	CMP	[0x5F],0xFF
07FC  B0 06	JNZ	0x0803
07FE  3C 60 FF	CMP	[0x60],0xFF
0801  A0 1B	JZ	0x081D
0803  52 FA	MOV	A,[X+0xFA]
0805  53 55	MOV	[0x55],A
0807  50 00	MOV	A,0x00
0809  3A 5D	CMP	A,[0x5D]
080B  B0 3E	JNZ	0x084A
080D  3A 5E	CMP	A,[0x5E]
080F  B0 3A	JNZ	0x084A
0811  51 55	MOV	A,[0x55]
0813  3A 5F	CMP	A,[0x5F]
0815  B0 34	JNZ	0x084A
0817  50 00	MOV	A,0x00
0819  3A 60	CMP	A,[0x60]
081B  B0 2E	JNZ	0x084A
081D  52 FB	MOV	A,[X+0xFB]
081F  21 FE	AND	A,0xFE
0821  55 55 00	MOV	[0x55],0x00
0824  55 56 00	MOV	[0x56],0x00
0827  55 57 00	MOV	[0x57],0x00
082A  3C 57 00	CMP	[0x57],0x00
082D  B0 19	JNZ	0x0847
082F  3C 56 00	CMP	[0x56],0x00
0832  B0 14	JNZ	0x0847
0834  3C 55 00	CMP	[0x55],0x00
0837  B0 0F	JNZ	0x0847
0839  39 18	CMP	A,0x18
083B  B0 0B	JNZ	0x0847
083D  3C 3D 00	CMP	[0x3D],0x00
0840  B0 09	JNZ	0x084A
0842  55 3D 01	MOV	[0x3D],0x01
0845  80 04	JMP	0x084A
0847  55 3D 00	MOV	[0x3D],0x00
084A  52 F8	MOV	A,[X+0xF8]
084C  08	PUSH	A
084D  52 F9	MOV	A,[X+0xF9]
084F  08	PUSH	A
0850  52 FA	MOV	A,[X+0xFA]
0852  08	PUSH	A
0853  52 FB	MOV	A,[X+0xFB]
0855  08	PUSH	A
0856  50 25	MOV	A,0x25
0858  08	PUSH	A
0859  7C 0E 87	LCALL	0x0E87	; func23
085C  38 FB	ADD	SP,0xFB
085E  20	POP	X
085F  7F	RET

func2:
0860  10	PUSH	X
0861  4F	MOV	X,SP
0862  38 0C	ADD	SP,0x0C
0864  55 61 01	MOV	[0x61],0x01
0867  62 14 01	MOV	REG[0x14],0x01 ; GPIO1.7 as output
086A  62 0C 01	MOV	REG[0x0C],0x01 ; GPIO0.7 as output
086D  49 FF 20	TST	REG[0xFF],0x20 ; watchdog event?
0870  A0 06	JZ	0x0877
0872  55 64 01	MOV	[0x64],0x01 ; watchdog fired
0875  80 04	JMP	0x087A
0877  55 64 00	MOV	[0x64],0x00 ; watchdog not fired
087A  55 7B 00	MOV	[0x7B],0x00
087D  5F 7C 64	MOV	[0x7C],[0x64]
0880  55 7D 0E	MOV	[0x7D],0x0E
0883  5F 7E 64	MOV	[0x7E],[0x64]
0886  55 3D 00	MOV	[0x3D],0x00
0889  10	PUSH	X
088A  7C 03 F1	LCALL	0x03F1 	; enable_timer1_int
088D  7C 03 F9	LCALL	0x03F9	; dummy2
0890  20	POP	X
0891  62 E0 B2	MOV	REG[0xE0],0xB2 ; INT_MSK0 (INT0, INT1, GPIO0, GPIO1)
0894  71 10	OR	F,0x10
0896  62 E3 15	MOV	REG[0xE3],0x15
0899  70 EF	AND	F,0xEF
089B  43 E0 01	OR	REG[0xE0],0x01 ; INT_MSK0 (POR)
089E  71 01	OR	F,0x01
08A0  41 01 FB	AND	REG[0x01],0xFB ; pull GPIO1.2 low)
08A3  62 2B 03	MOV	REG[0x2B],0x03 ; TCAPINTE (CAP1 rise/fall)
08A6  62 2A 08	MOV	REG[0x2A],0x08 ; TMRCR (16bit capture enable)
08A9  43 DF 02	OR	REG[0xDF],0x02 ; INT_MSK2 (16bit counter wrap int enable)
08AC  10	PUSH	X
08AD  50 00	MOV	A,0x00
08AF  7C 1D C4	LCALL	0x1DC4	; USB_Start
08B2  20	POP	X
08B3  41 00 F7	AND	REG[0x00],0xF7 ; P0DATA (pull GPIO0.3 low)
08B6  49 01 10	TST	REG[0x01],0x10 ; P1DATA (check GPIO1.4)
08B9  B0 06	JNZ	0x08C0
08BB  55 44 0C	MOV	[0x44],0x0C ; remember detection?
08BE  80 04	JMP	0x08C3
08C0  55 44 04	MOV	[0x44],0x04
08C3  71 10	OR	F,0x10
08C5  62 E0 13	MOV	REG[0xE0],0x13 ; INT_MSK0 (POR, INT0, GPIO0)
08C8  70 EF	AND	F,0xEF
08CA  41 FF EF	AND	REG[0xFF],0xEF ; CPU_SCR (clear PORS)
08CD  81 76	JMP	0x0A44	; dummy, returns here at 0x8cf

func51:
;; maybe led handling?
;; white and orange leds connected to gpio0/1.7?
08CF  62 E3 00	MOV	REG[0xE3],0x00 ; watchdog
08D2  3C 44 0C	CMP	[0x44],0x0C
08D5  B0 30	JNZ	0x0906

08D7  3C 46 02	CMP	[0x46],0x02 ; timer msb
08DA  D0 09	JNC	0x08E4

08DC  43 00 08	OR	REG[0x00],0x08 ; P0DATA (GPIO0.3)
08DF  41 01 7F	AND	REG[0x01],0x7F ; P1DATA (pull GPIO1.7 low)
08E2  80 19	JMP	0x08FC

08E4  3C 46 06	CMP	[0x46],0x06
08E7  D0 0E	JNC	0x08F6
08E9  3C 46 04	CMP	[0x46],0x04
08EC  C0 09	JC	0x08F6
08EE  41 00 F7	AND	REG[0x00],0xF7 ; P0DATA (pull GPIO0.7 low)
08F1  43 01 80	OR	REG[0x01],0x80 ; P1DATA (GPIO1.7)
08F4  80 07	JMP	0x08FC

08F6  41 00 F7	AND	REG[0x00],0xF7 ; P0DATA (pull GPIO0.7 low)
08F9  41 01 7F	AND	REG[0x01],0x7F ; P1DATA (pull GPIO1.7 low)
08FC  3C 46 08	CMP	[0x46],0x08
08FF  C0 3A	JC	0x093A

0901  55 46 00	MOV	[0x46],0x00
0904  80 35	JMP	0x093A

0906  47 44 04	TST	[0x44],0x04
0909  A0 13	JZ	0x091D
090B  3C 46 02	CMP	[0x46],0x02
090E  D0 06	JNC	0x0915
0910  41 00 F7	AND	REG[0x00],0xF7 ; P0DATA (pull GPIO0.7 low)
0913  80 04	JMP	0x0918

0915  43 00 08	OR	REG[0x00],0x08 ; P0DATA (GPIO0.3)
0918  41 01 7F	AND	REG[0x01],0x7F ; P1DATA (pull GPIO1.7 low)
091B  80 16	JMP	0x0932

091D  47 44 08	TST	[0x44],0x08
0920  A0 11	JZ	0x0932
0922  3C 46 02	CMP	[0x46],0x02
0925  D0 06	JNC	0x092C
0927  43 01 80	OR	REG[0x01],0x80 ; P1DATA (GPIO1.7)
092A  80 04	JMP	0x092F

092C  41 01 7F	AND	REG[0x01],0x7F ; P1DATA (pull GPIO1.7 low)
092F  41 00 F7	AND	REG[0x00],0xF7 ; P0DATA (pull GPIO0.7 low)

0932  3C 46 04	CMP	[0x46],0x04
0935  C0 04	JC	0x093A
0937  55 46 00	MOV	[0x46],0x00

093A  5D 2C	MOV	A,REG[0x2C] ; TCAPINTS
093C  39 03	CMP	A,0x03	    ; cap0 interrupts occurred?
093E  B0 12	JNZ	0x0951

0940  3D 01 0A	CMP	[X+0x01],0x0A
0943  B0 09	JNZ	0x094D
0945  56 01 00	MOV	[X+0x01],0x00
0948  62 2C 03	MOV	REG[0x2C],0x03
094B  80 08	JMP	0x0954

094D  77 01	INC	[X+0x01]
094F  80 04	JMP	0x0954

0951  56 01 00	MOV	[X+0x01],0x00
0954  3C 3D 01	CMP	[0x3D],0x01
0957  B0 05	JNZ	0x095D
0959  70 FE	AND	F,0xFE
095B  8F FF	JMP	0x095B

095D  3C 61 00	CMP	[0x61],0x00
0960  A0 2A	JZ	0x098B
0962  3C 41 00	CMP	[0x41],0x00
0965  A0 01	JZ	0x0967
0967  7C 0B 51	LCALL	0x0B51	; func24
096A  55 67 00	MOV	[0x67],0x00
096D  55 65 40	MOV	[0x65],0x40
0970  7C 10 11	LCALL	0x1011	; func72
0973  55 41 00	MOV	[0x41],0x00
0976  55 61 00	MOV	[0x61],0x00
0979  71 01	OR	F,0x01

097B  5D 21	MOV	A,REG[0x21] ; FRTMRH (free running timer)
097D  53 6B	MOV	[0x6B],A    ; timerH
097F  5D 20	MOV	A,REG[0x20] ; FRTMRL
0981  53 6A	MOV	[0x6A],A    ; timerL
0983  5F 83 6B	MOV	[0x83],[0x6B]
0986  5F 84 6A	MOV	[0x84],[0x6A]
0989  80 BA	JMP	0x0A44	; .next

098B  10	PUSH	X
098C  7C 1E 0F	LCALL	0x1E0F	; USB_bGetConfiguration
098F  20	POP	X
0990  39 00	CMP	A,0x00
0992  A0 B1	JZ	0x0A44	; .next

0994  43 E1 80	OR	REG[0xE1],0x80 ; enable TCAP0 int
0997  7C 0B 88	LCALL	0x0B88	; func18
099A  7C 10 15	LCALL	0x1015	; func19
099D  39 00	CMP	A,0x00
099F  B0 3F	JNZ	0x09DF
09A1  10	PUSH	X
09A2  7C 1E 1E	LCALL	0x1E1E	; func17
09A5  20	POP	X
09A6  39 00	CMP	A,0x00
09A8  A0 09	JZ	0x09B2
09AA  3C 41 09	CMP	[0x41],0x09
09AD  B0 04	JNZ	0x09B2
09AF  7C 0E 50	LCALL	0x0E50	; func22
09B2  3C 41 00	CMP	[0x41],0x00
09B5  B0 29	JNZ	0x09DF
09B7  10	PUSH	X
09B8  50 02	MOV	A,0x02
09BA  7C 1E 12	LCALL	0x1E12	; func20
09BD  20	POP	X
09BE  39 01	CMP	A,0x01
09C0  B0 1E	JNZ	0x09DF
09C2  7C 0F DF	LCALL	0x0FDF	; func73
;; send 5 bytes to endpoint 2
09C5  51 56	MOV	A,[0x56] ; address of data
09C7  54 0B	MOV	[X+0x0B],A
09C9  51 57	MOV	A,[0x57]
09CB  54 0A	MOV	[X+0x0A],A
09CD  55 2D 02	MOV	[0x2D],0x02 ; USB_APIEPNumber
09D0  55 2E 05	MOV	[0x2E],0x05 ; USB_APICount
09D3  10	PUSH	X
09D4  52 0A	MOV	A,[X+0x0A]
09D6  08	PUSH	A
09D7  52 0B	MOV	A,[X+0x0B]
09D9  5C	MOV	X,A
09DA  18	POP	A
09DB  7C 1E 3A	LCALL	0x1E3A	; USB_XLoadEP
09DE  20	POP	X
09DF  3C 65 40	CMP	[0x65],0x40
09E2  D0 61	JNC	0x0A44	; .next
09E4  56 00 00	MOV	[X+0x00],0x00
09E7  80 34	JMP	0x0A1C
09E9  52 00	MOV	A,[X+0x00]
09EB  53 56	MOV	[0x56],A
09ED  55 57 00	MOV	[0x57],0x00
09F0  51 65	MOV	A,[0x65]
09F2  02 56	ADD	A,[0x56]
09F4  53 56	MOV	[0x56],A
09F6  50 00	MOV	A,0x00
09F8  0A 57	ADC	A,[0x57]
09FA  53 57	MOV	[0x57],A
09FC  06 56 00	ADD	[0x56],0x00
09FF  0E 57 12	ADC	[0x57],0x12
0A02  51 57	MOV	A,[0x57]
0A04  10	PUSH	X
0A05  58 56	MOV	X,[0x56]
0A07  28	ROMX
0A08  20	POP	X
0A09  53 57	MOV	[0x57],A
0A0B  5A 54	MOV	[0x54],X
0A0D  06 54 02	ADD	[0x54],0x02
0A10  52 00	MOV	A,[X+0x00]
0A12  02 54	ADD	A,[0x54]
0A14  53 54	MOV	[0x54],A
0A16  51 57	MOV	A,[0x57]
0A18  3F 54	MVI	[[0x54]++],A
0A1A  77 00	INC	[X+0x00]
0A1C  3D 00 08	CMP	[X+0x00],0x08
0A1F  CF C9	JC	0x09E9
0A21  10	PUSH	X
0A22  50 01	MOV	A,0x01
0A24  7C 1E 12	LCALL	0x1E12	; func20
0A27  20	POP	X
0A28  39 01	CMP	A,0x01
0A2A  B0 19	JNZ	0x0A44	    ; .next
0A2C  55 2D 01	MOV	[0x2D],0x01 ; USB_APIEPNumber
0A2F  55 2E 08	MOV	[0x2E],0x08 ; USB_APICount
0A32  5A 56	MOV	[0x56],X
0A34  06 56 02	ADD	[0x56],0x02
0A37  10	PUSH	X
0A38  08	PUSH	A
0A39  51 56	MOV	A,[0x56]
0A3B  5C	MOV	X,A
0A3C  18	POP	A
0A3D  7C 1E 3A	LCALL	0x1E3A	; USB_XLoadEP
0A40  20	POP	X
0A41  06 65 08	ADD	[0x65],0x08
.next:
0A44  8E 8A	JMP	0x08CF	; func51, next iteration

0A46  38 F4	ADD	SP,0xF4
0A48  20	POP	X
0A49  8F FF	JMP	0x0A49

handle_gpio1:
0A4B  70 FE	AND	F,0xFE
0A4D  8F FF	JMP	0x0A4D	; forever
0A4F  7E	RETI

timer16_handler:
0A50  3C 67 FF	CMP	[0x67],0xFF
0A53  D0 03	JNC	0x0A57
0A55  76 67	INC	[0x67]
0A57  7E	RETI

handle_timer_cap0:
0A58  08	PUSH	A
0A59  5D D0	MOV	A,REG[0xD0]
0A5B  08	PUSH	A
0A5C  5D D3	MOV	A,REG[0xD3]
0A5E  08	PUSH	A
0A5F  5D D4	MOV	A,REG[0xD4]
0A61  08	PUSH	A
0A62  5D D5	MOV	A,REG[0xD5]
0A64  08	PUSH	A
0A65  51 57	MOV	A,[0x57]
0A67  08	PUSH	A
0A68  51 56	MOV	A,[0x56]
0A6A  08	PUSH	A
0A6B  51 55	MOV	A,[0x55]
0A6D  08	PUSH	A
0A6E  51 54	MOV	A,[0x54]
0A70  08	PUSH	A
0A71  51 53	MOV	A,[0x53]
0A73  08	PUSH	A
0A74  51 52	MOV	A,[0x52]
0A76  08	PUSH	A
0A77  51 51	MOV	A,[0x51]
0A79  08	PUSH	A
0A7A  51 50	MOV	A,[0x50]
0A7C  08	PUSH	A
0A7D  51 4F	MOV	A,[0x4F]
0A7F  08	PUSH	A
0A80  51 4E	MOV	A,[0x4E]
0A82  08	PUSH	A
0A83  51 4D	MOV	A,[0x4D]
0A85  08	PUSH	A
0A86  51 4C	MOV	A,[0x4C]
0A88  08	PUSH	A
0A89  51 4B	MOV	A,[0x4B]
0A8B  08	PUSH	A
0A8C  51 4A	MOV	A,[0x4A]
0A8E  08	PUSH	A
0A8F  51 49	MOV	A,[0x49]
0A91  08	PUSH	A
0A92  10	PUSH	X
0A93  4F	MOV	X,SP
0A94  38 06	ADD	SP,0x06
0A96  62 E3 00	MOV	REG[0xE3],0x00
0A99  49 2C 01	TST	REG[0x2C],0x01
0A9C  A0 08	JZ	0x0AA5
0A9E  5D 23	MOV	A,REG[0x23]
0AA0  54 01	MOV	[X+0x01],A
0AA2  56 00 00	MOV	[X+0x00],0x00
0AA5  49 2C 02	TST	REG[0x2C],0x02
0AA8  A0 08	JZ	0x0AB1
0AAA  5D 25	MOV	A,REG[0x25]
0AAC  54 01	MOV	[X+0x01],A
0AAE  56 00 00	MOV	[X+0x00],0x00
0AB1  49 DC 02	TST	REG[0xDC],0x02
0AB4  A0 10	JZ	0x0AC5
0AB6  52 01	MOV	A,[X+0x01]
0AB8  11 20	SUB	A,0x20
0ABA  52 00	MOV	A,[X+0x00]
0ABC  19 00	SBB	A,0x00
0ABE  D0 06	JNC	0x0AC5
0AC0  76 67	INC	[0x67]
0AC2  41 DC FD	AND	REG[0xDC],0xFD
0AC5  3C 67 00	CMP	[0x67],0x00
0AC8  A0 25	JZ	0x0AEE
0ACA  51 67	MOV	A,[0x67]
0ACC  54 03	MOV	[X+0x03],A
0ACE  56 02 00	MOV	[X+0x02],0x00
0AD1  52 03	MOV	A,[X+0x03]
0AD3  54 02	MOV	[X+0x02],A
0AD5  56 03 00	MOV	[X+0x03],0x00
0AD8  52 01	MOV	A,[X+0x01]
0ADA  05 03	ADD	[X+0x03],A
0ADC  52 00	MOV	A,[X+0x00]
0ADE  0D 02	ADC	[X+0x02],A
0AE0  52 03	MOV	A,[X+0x03]
0AE2  12 3F	SUB	A,[0x3F]
0AE4  54 05	MOV	[X+0x05],A
0AE6  52 02	MOV	A,[X+0x02]
0AE8  1A 3E	SBB	A,[0x3E]
0AEA  54 04	MOV	[X+0x04],A
0AEC  80 0D	JMP	0x0AFA
0AEE  52 01	MOV	A,[X+0x01]
0AF0  12 3F	SUB	A,[0x3F]
0AF2  54 05	MOV	[X+0x05],A
0AF4  52 00	MOV	A,[X+0x00]
0AF6  1A 3E	SBB	A,[0x3E]
0AF8  54 04	MOV	[X+0x04],A
0AFA  52 04	MOV	A,[X+0x04]
0AFC  08	PUSH	A
0AFD  52 05	MOV	A,[X+0x05]
0AFF  08	PUSH	A
0B00  7C 04 0C	LCALL	0x040C	; func60
0B03  38 FE	ADD	SP,0xFE
0B05  52 01	MOV	A,[X+0x01]
0B07  53 3F	MOV	[0x3F],A
0B09  52 00	MOV	A,[X+0x00]
0B0B  53 3E	MOV	[0x3E],A
0B0D  55 67 00	MOV	[0x67],0x00
0B10  62 2C 03	MOV	REG[0x2C],0x03
0B13  38 FA	ADD	SP,0xFA
0B15  20	POP	X
0B16  18	POP	A
0B17  53 49	MOV	[0x49],A
0B19  18	POP	A
0B1A  53 4A	MOV	[0x4A],A
0B1C  18	POP	A
0B1D  53 4B	MOV	[0x4B],A
0B1F  18	POP	A
0B20  53 4C	MOV	[0x4C],A
0B22  18	POP	A
0B23  53 4D	MOV	[0x4D],A
0B25  18	POP	A
0B26  53 4E	MOV	[0x4E],A
0B28  18	POP	A
0B29  53 4F	MOV	[0x4F],A
0B2B  18	POP	A
0B2C  53 50	MOV	[0x50],A
0B2E  18	POP	A
0B2F  53 51	MOV	[0x51],A
0B31  18	POP	A
0B32  53 52	MOV	[0x52],A
0B34  18	POP	A
0B35  53 53	MOV	[0x53],A
0B37  18	POP	A
0B38  53 54	MOV	[0x54],A
0B3A  18	POP	A
0B3B  53 55	MOV	[0x55],A
0B3D  18	POP	A
0B3E  53 56	MOV	[0x56],A
0B40  18	POP	A
0B41  53 57	MOV	[0x57],A
0B43  18	POP	A
0B44  60 D5	MOV	REG[0xD5],A
0B46  18	POP	A
0B47  60 D4	MOV	REG[0xD4],A
0B49  18	POP	A
0B4A  60 D3	MOV	REG[0xD3],A
0B4C  18	POP	A
0B4D  60 D0	MOV	REG[0xD0],A
0B4F  18	POP	A
0B50  7E	RETI

func24:
0B51  55 7F 00	MOV	[0x7F],0x00
0B54  55 85 00	MOV	[0x85],0x00
0B57  55 82 01	MOV	[0x82],0x01
0B5A  55 88 01	MOV	[0x88],0x01
0B5D  55 89 20	MOV	[0x89],0x20
0B60  55 8A 05	MOV	[0x8A],0x05
0B63  55 8B FF	MOV	[0x8B],0xFF
0B66  55 8C FF	MOV	[0x8C],0xFF
0B69  55 8D 06	MOV	[0x8D],0x06
0B6C  55 8E 01	MOV	[0x8E],0x01
0B6F  55 8F 07	MOV	[0x8F],0x07
0B72  55 90 00	MOV	[0x90],0x00
0B75  55 91 08	MOV	[0x91],0x08
0B78  55 92 00	MOV	[0x92],0x00
0B7B  55 93 09	MOV	[0x93],0x09
0B7E  55 94 01	MOV	[0x94],0x01
0B81  55 95 0B	MOV	[0x95],0x0B
0B84  55 96 01	MOV	[0x96],0x01
0B87  7F	RET

func18:
0B88  10	PUSH	X
0B89  4F	MOV	X,SP
0B8A  38 05	ADD	SP,0x05
0B8C  3C 97 01	CMP	[0x97],0x01
0B8F  B0 2B	JNZ	0x0BBB
0B91  3C 40 00	CMP	[0x40],0x00
0B94  B0 23	JNZ	0x0BB8
0B96  51 6B	MOV	A,[0x6B]
0B98  31 54	XOR	A,0x54
0B9A  53 69	MOV	[0x69],A
0B9C  51 6A	MOV	A,[0x6A]
0B9E  31 4C	XOR	A,0x4C
0BA0  53 68	MOV	[0x68],A

0BA2  5D 21	MOV	A,REG[0x21] ; FRTMRH
0BA4  53 6B	MOV	[0x6B],A
0BA6  5D 20	MOV	A,REG[0x20] ; FRTMRL
0BA8  53 6A	MOV	[0x6A],A
0BAA  5F 83 6B	MOV	[0x83],[0x6B]
0BAD  5F 84 6A	MOV	[0x84],[0x6A]

0BB0  55 97 00	MOV	[0x97],0x00
0BB3  55 40 01	MOV	[0x40],0x01
0BB6  80 04	JMP	0x0BBB
0BB8  55 40 00	MOV	[0x40],0x00
0BBB  3C 85 00	CMP	[0x85],0x00
0BBE  A0 1B	JZ	0x0BDA
0BC0  55 85 00	MOV	[0x85],0x00
0BC3  51 86	MOV	A,[0x86]
0BC5  3A 69	CMP	A,[0x69]
0BC7  B0 0F	JNZ	0x0BD7
0BC9  51 87	MOV	A,[0x87]
0BCB  3A 68	CMP	A,[0x68]
0BCD  B0 09	JNZ	0x0BD7
0BCF  3C 40 01	CMP	[0x40],0x01
0BD2  B0 04	JNZ	0x0BD7
0BD4  55 65 00	MOV	[0x65],0x00
0BD7  55 40 00	MOV	[0x40],0x00
0BDA  3C 9A 01	CMP	[0x9A],0x01
0BDD  B0 0A	JNZ	0x0BE8
0BDF  5F 7C 64	MOV	[0x7C],[0x64]
0BE2  5F 7E 64	MOV	[0x7E],[0x64]
0BE5  55 9A 00	MOV	[0x9A],0x00
0BE8  3C 9D 01	CMP	[0x9D],0x01
0BEB  B0 10	JNZ	0x0BFC
0BED  55 7C 00	MOV	[0x7C],0x00
0BF0  55 7E 00	MOV	[0x7E],0x00
0BF3  55 9D 00	MOV	[0x9D],0x00
0BF6  55 64 00	MOV	[0x64],0x00
0BF9  41 FF DF	AND	REG[0xFF],0xDF
0BFC  3C 7F 00	CMP	[0x7F],0x00
0BFF  A1 82	JZ	0x0D82

0C01  51 7F	MOV	A,[0x7F]
0C03  54 02	MOV	[X+0x02],A
0C05  56 01 00	MOV	[X+0x01],0x00
0C08  3D 01 00	CMP	[X+0x01],0x00
0C0B  B0 06	JNZ	0x0C12
0C0D  3D 02 02	CMP	[X+0x02],0x02
0C10  A0 41	JZ	0x0C52

0C12  3D 01 00	CMP	[X+0x01],0x00
0C15  B0 06	JNZ	0x0C1C
0C17  3D 02 03	CMP	[X+0x02],0x03
0C1A  A0 50	JZ	0x0C6B
0C1C  3D 01 00	CMP	[X+0x01],0x00
0C1F  B0 06	JNZ	0x0C26
0C21  3D 02 04	CMP	[X+0x02],0x04
0C24  A0 5D	JZ	0x0C82
0C26  52 02	MOV	A,[X+0x02]
0C28  11 02	SUB	A,0x02
0C2A  52 01	MOV	A,[X+0x01]
0C2C  31 80	XOR	A,0x80
0C2E  19 80	SBB	A,0x80
0C30  C1 4C	JC	0x0D7D

0C32  3D 01 00	CMP	[X+0x01],0x00
0C35  B0 06	JNZ	0x0C3C

0C37  3D 02 0A	CMP	[X+0x02],0x0A ; upgrade
0C3A  A0 5E	JZ	0x0C99

0C3C  3D 01 00	CMP	[X+0x01],0x00
0C3F  B0 06	JNZ	0x0C46
0C41  3D 02 0D	CMP	[X+0x02],0x0D ; set led
0C44  A0 A2	JZ	0x0CE7
0C46  3D 01 00	CMP	[X+0x01],0x00
0C49  B0 06	JNZ	0x0C50
0C4B  3D 02 0F	CMP	[X+0x02],0x0F ; set fan
0C4E  A1 21	JZ	0x0D70
0C50  81 2C	JMP	0x0D7D

0C52  55 37 00	MOV	[0x37],0x00
0C55  55 5D FF	MOV	[0x5D],0xFF
0C58  55 5E FF	MOV	[0x5E],0xFF
0C5B  55 5F FF	MOV	[0x5F],0xFF
0C5E  55 60 FF	MOV	[0x60],0xFF
0C61  9E EE	CALL	0x0B51	; func24
0C63  41 00 E5	AND	REG[0x00],0xE5 ; P0DATA (pull low GPIO0.1, GPIO0.3, GPIO0.4)
0C66  41 01 7F	AND	REG[0x01],0x7F ; P1DATA (pull low GPIO1.7)
0C69  81 13	JMP	0x0D7D

0C6B  55 37 01	MOV	[0x37],0x01
0C6E  55 5D FF	MOV	[0x5D],0xFF
0C71  55 5E FF	MOV	[0x5E],0xFF
0C74  55 5F FF	MOV	[0x5F],0xFF
0C77  55 60 FF	MOV	[0x60],0xFF
0C7A  55 8B FF	MOV	[0x8B],0xFF
0C7D  55 8C FF	MOV	[0x8C],0xFF
0C80  80 FC	JMP	0x0D7D

0C82  55 37 00	MOV	[0x37],0x00
0C85  55 5D FF	MOV	[0x5D],0xFF
0C88  55 5E FF	MOV	[0x5E],0xFF
0C8B  55 5F FF	MOV	[0x5F],0xFF
0C8E  55 60 FF	MOV	[0x60],0xFF
0C91  55 8B FF	MOV	[0x8B],0xFF
0C94  55 8C FF	MOV	[0x8C],0xFF
0C97  80 E5	JMP	0x0D7D
.upgrade:
0C99  56 04 00	MOV	[X+0x04],0x00
0C9C  56 03 00	MOV	[X+0x03],0x00
0C9F  80 07	JMP	0x0CA7
0CA1  40	NOP

0CA2  77 04	INC	[X+0x04]
0CA4  0F 03 00	ADC	[X+0x03],0x00

0CA7  52 04	MOV	A,[X+0x04]
0CA9  11 E8	SUB	A,0xE8
0CAB  52 03	MOV	A,[X+0x03]
0CAD  19 03	SBB	A,0x03
0CAF  CF F1	JC	0x0CA1
0CB1  62 E3 00	MOV	REG[0xE3],0x00
0CB4  70 FE	AND	F,0xFE
0CB6  10	PUSH	X
0CB7  7C 1D E8	LCALL	0x1DE8	; USB_Stop
0CBA  7C 03 F5	LCALL	0x03F5 	; disable_timer1_int
0CBD  7C 03 FA	LCALL	0x03FA	; disable_timer1_int_b
0CC0  20	POP	X
0CC1  56 04 00	MOV	[X+0x04],0x00
0CC4  56 03 00	MOV	[X+0x03],0x00
0CC7  80 07	JMP	0x0CCF
0CC9  40	NOP
0CCA  77 04	INC	[X+0x04]
0CCC  0F 03 00	ADC	[X+0x03],0x00
0CCF  52 04	MOV	A,[X+0x04]
0CD1  11 E8	SUB	A,0xE8
0CD3  52 03	MOV	A,[X+0x03]
0CD5  19 03	SBB	A,0x03
0CD7  CF F1	JC	0x0CC9
0CD9  62 E3 00	MOV	REG[0xE3],0x00
0CDC  41 01 7F	AND	REG[0x01],0x7F ; P1DATA (pull GPIO1.7 low)
0CDF  43 00 08	OR	REG[0x00],0x08 ; P0DATA (GPIO0.3)
0CE2  7C 13 D5	LCALL	0x13D5	; _EnterBootloader
0CE5  80 97	JMP	0x0D7D
.set_led:
0CE7  51 80	MOV	A,[0x80]
0CE9  54 04	MOV	[X+0x04],A
0CEB  56 03 00	MOV	[X+0x03],0x00
0CEE  3D 03 00	CMP	[X+0x03],0x00
0CF1  B0 06	JNZ	0x0CF8
0CF3  3D 04 03	CMP	[X+0x04],0x03
0CF6  A0 21	JZ	0x0D18
0CF8  3D 03 00	CMP	[X+0x03],0x00
0CFB  B0 06	JNZ	0x0D02

0CFD  3D 04 04	CMP	[X+0x04],0x04
0D00  A0 34	JZ	0x0D35

0D02  3D 03 00	CMP	[X+0x03],0x00
0D05  B0 06	JNZ	0x0D0C
0D07  3D 04 05	CMP	[X+0x04],0x05
0D0A  A0 47	JZ	0x0D52
0D0C  3D 03 00	CMP	[X+0x03],0x00
0D0F  B0 06	JNZ	0x0D16
0D11  3D 04 06	CMP	[X+0x04],0x06
0D14  A0 4F	JZ	0x0D64

0D16  80 66	JMP	0x0D7D

0D18  55 44 00	MOV	[0x44],0x00
0D1B  3C 81 02	CMP	[0x81],0x02
0D1E  B0 04	JNZ	0x0D23
0D20  2E 44 04	OR	[0x44],0x04

0D23  3C 81 01	CMP	[0x81],0x01
0D26  B0 04	JNZ	0x0D2B

0D28  43 00 08	OR	REG[0x00],0x08 ; P0DATA (GPIO0.3)
0D2B  3C 81 00	CMP	[0x81],0x00
0D2E  B0 4E	JNZ	0x0D7D
0D30  41 00 F7	AND	REG[0x00],0xF7 ; P0DATA (pull GPIO1.7 low)
0D33  80 49	JMP	0x0D7D

0D35  55 44 00	MOV	[0x44],0x00
0D38  3C 81 02	CMP	[0x81],0x02
0D3B  B0 04	JNZ	0x0D40
0D3D  2E 44 08	OR	[0x44],0x08
0D40  3C 81 01	CMP	[0x81],0x01
0D43  B0 04	JNZ	0x0D48
0D45  43 01 80	OR	REG[0x01],0x80 ; P1DATA (GPIO01.3)
0D48  3C 81 00	CMP	[0x81],0x00
0D4B  B0 31	JNZ	0x0D7D
0D4D  41 01 7F	AND	REG[0x01],0x7F ; P1DATA (pull GPIO1.7 low)
0D50  80 2C	JMP	0x0D7D

0D52  3C 81 01	CMP	[0x81],0x01
0D55  B0 04	JNZ	0x0D5A
0D57  43 00 01	OR	REG[0x00],0x01 ; P0DATA (GPIO0.1)
0D5A  3C 81 00	CMP	[0x81],0x00
0D5D  B0 1F	JNZ	0x0D7D
0D5F  41 00 FE	AND	REG[0x00],0xFE ; P0DATA (pull GPIO0.1 low)
0D62  80 1A	JMP	0x0D7D

0D64  3C 81 01	CMP	[0x81],0x01
0D67  B0 15	JNZ	0x0D7D
0D69  2E 44 0C	OR	[0x44],0x0C
0D6C  51 44	MOV	A,[0x44]
0D6E  80 0E	JMP	0x0D7D
.set_fan:
0D70  3C 80 00	CMP	[0x80],0x00
0D73  A0 06	JZ	0x0D7A
0D75  41 00 7F	AND	REG[0x00],0x7F ; P0DATA (pull GPIO0.7 low)
0D78  80 04	JMP	0x0D7D
0D7A  43 00 80	OR	REG[0x00],0x80 ; P0DATA (GPIO0.7)

0D7D  55 7F 00	MOV	[0x7F],0x00
0D80  80 33	JMP	0x0DB4

0D82  3C 8B FF	CMP	[0x8B],0xFF
0D85  A0 18	JZ	0x0D9E

0D87  5F 57 8C	MOV	[0x57],[0x8C]
0D8A  55 56 00	MOV	[0x56],0x00
0D8D  26 56 00	AND	[0x56],0x00
0D90  5F 60 56	MOV	[0x60],[0x56]
0D93  5F 5F 57	MOV	[0x5F],[0x57]
0D96  55 5E 00	MOV	[0x5E],0x00
0D99  55 5D 00	MOV	[0x5D],0x00
0D9C  80 17	JMP	0x0DB4

0D9E  3C 8B FF	CMP	[0x8B],0xFF
0DA1  B0 12	JNZ	0x0DB4
0DA3  3C 8C FF	CMP	[0x8C],0xFF
0DA6  B0 0D	JNZ	0x0DB4
0DA8  55 5D FF	MOV	[0x5D],0xFF
0DAB  55 5E FF	MOV	[0x5E],0xFF
0DAE  55 5F FF	MOV	[0x5F],0xFF
0DB1  55 60 FF	MOV	[0x60],0xFF

0DB4  38 FB	ADD	SP,0xFB
0DB6  20	POP	X
0DB7  7F	RET

handle_1ms:
0DB8  08	PUSH	A
0DB9  5D D0	MOV	A,REG[0xD0]
0DBB  08	PUSH	A
0DBC  5D D3	MOV	A,REG[0xD3]
0DBE  08	PUSH	A
0DBF  5D D4	MOV	A,REG[0xD4]
0DC1  08	PUSH	A
0DC2  5D D5	MOV	A,REG[0xD5]
0DC4  08	PUSH	A
0DC5  51 57	MOV	A,[0x57]
0DC7  08	PUSH	A
0DC8  51 56	MOV	A,[0x56]
0DCA  08	PUSH	A
0DCB  51 55	MOV	A,[0x55]
0DCD  08	PUSH	A
0DCE  51 54	MOV	A,[0x54]
0DD0  08	PUSH	A
0DD1  51 53	MOV	A,[0x53]
0DD3  08	PUSH	A
0DD4  51 52	MOV	A,[0x52]
0DD6  08	PUSH	A
0DD7  51 51	MOV	A,[0x51]
0DD9  08	PUSH	A
0DDA  51 50	MOV	A,[0x50]
0DDC  08	PUSH	A
0DDD  51 4F	MOV	A,[0x4F]
0DDF  08	PUSH	A
0DE0  51 4E	MOV	A,[0x4E]
0DE2  08	PUSH	A
0DE3  51 4D	MOV	A,[0x4D]
0DE5  08	PUSH	A
0DE6  51 4C	MOV	A,[0x4C]
0DE8  08	PUSH	A
0DE9  51 4B	MOV	A,[0x4B]
0DEB  08	PUSH	A
0DEC  51 4A	MOV	A,[0x4A]
0DEE  08	PUSH	A
0DEF  51 49	MOV	A,[0x49]
0DF1  08	PUSH	A
0DF2  76 45	INC	[0x45]	; timer lsb?
0DF4  3C 45 FF	CMP	[0x45],0xFF
0DF7  B0 03	JNZ	0x0DFB
0DF9  76 46	INC	[0x46]	; timer msb?
0DFB  10	PUSH	X
0DFC  7C 1E 01	LCALL	0x1E01	; timer_handler (USB_bCheckActivity)
0DFF  20	POP	X
0E00  39 00	CMP	A,0x00
0E02  A0 0B	JZ	0x0E0E
0E04  3C 41 00	CMP	[0x41],0x00
0E07  A0 01	JZ	0x0E09
0E09  55 41 00	MOV	[0x41],0x00
0E0C  80 08	JMP	0x0E15
0E0E  3C 41 09	CMP	[0x41],0x09
0E11  D0 03	JNC	0x0E15
0E13  76 41	INC	[0x41]
0E15  18	POP	A
0E16  53 49	MOV	[0x49],A
0E18  18	POP	A
0E19  53 4A	MOV	[0x4A],A
0E1B  18	POP	A
0E1C  53 4B	MOV	[0x4B],A
0E1E  18	POP	A
0E1F  53 4C	MOV	[0x4C],A
0E21  18	POP	A
0E22  53 4D	MOV	[0x4D],A
0E24  18	POP	A
0E25  53 4E	MOV	[0x4E],A
0E27  18	POP	A
0E28  53 4F	MOV	[0x4F],A
0E2A  18	POP	A
0E2B  53 50	MOV	[0x50],A
0E2D  18	POP	A
0E2E  53 51	MOV	[0x51],A
0E30  18	POP	A
0E31  53 52	MOV	[0x52],A
0E33  18	POP	A
0E34  53 53	MOV	[0x53],A
0E36  18	POP	A
0E37  53 54	MOV	[0x54],A
0E39  18	POP	A
0E3A  53 55	MOV	[0x55],A
0E3C  18	POP	A
0E3D  53 56	MOV	[0x56],A
0E3F  18	POP	A
0E40  53 57	MOV	[0x57],A
0E42  18	POP	A
0E43  60 D5	MOV	REG[0xD5],A
0E45  18	POP	A
0E46  60 D4	MOV	REG[0xD4],A
0E48  18	POP	A
0E49  60 D3	MOV	REG[0xD3],A
0E4B  18	POP	A
0E4C  60 D0	MOV	REG[0xD0],A
0E4E  18	POP	A
0E4F  7E	RETI

func22:
0E50  10	PUSH	X
0E51  4F	MOV	X,SP
0E52  38 02	ADD	SP,0x02
0E54  10	PUSH	X
0E55  50 02	MOV	A,0x02
0E57  7C 1E A2	LCALL	0x1EA2	; func8
0E5A  50 01	MOV	A,0x01
0E5C  7C 1E A2	LCALL	0x1EA2	; func8
0E5F  20	POP	X
0E60  56 01 00	MOV	[X+0x01],0x00
0E63  56 00 00	MOV	[X+0x00],0x00
0E66  40	NOP
0E67  77 01	INC	[X+0x01]
0E69  0F 00 00	ADC	[X+0x00],0x00
0E6C  52 01	MOV	A,[X+0x01]
0E6E  11 E8	SUB	A,0xE8
0E70  52 00	MOV	A,[X+0x00]
0E72  31 80	XOR	A,0x80
0E74  19 83	SBB	A,0x83
0E76  CF EF	JC	0x0E66
0E78  10	PUSH	X
0E79  50 FF	MOV	A,0xFF
0E7B  7C 1E A2	LCALL	0x1EA2	; func8
0E7E  20	POP	X
0E7F  55 41 0A	MOV	[0x41],0x0A
0E82  38 FE	ADD	SP,0xFE
0E84  20	POP	X
0E85  7F	RET
0E86  7F	RET

func23:
0E87  10	PUSH	X
0E88  4F	MOV	X,SP
0E89  38 01	ADD	SP,0x01
0E8B  51 48	MOV	A,[0x48]
0E8D  01 01	ADD	A,0x01
0E8F  54 00	MOV	[X+0x00],A
0E91  3D 00 03	CMP	[X+0x00],0x03
0E94  C0 04	JC	0x0E99
0E96  56 00 00	MOV	[X+0x00],0x00
0E99  52 00	MOV	A,[X+0x00]
0E9B  53 56	MOV	[0x56],A
0E9D  50 00	MOV	A,0x00
0E9F  08	PUSH	A
0EA0  51 56	MOV	A,[0x56]
0EA2  08	PUSH	A
0EA3  50 00	MOV	A,0x00
0EA5  08	PUSH	A
0EA6  50 05	MOV	A,0x05
0EA8  08	PUSH	A
0EA9  7C 11 57	LCALL	0x1157	; func9
0EAC  38 FC	ADD	SP,0xFC
0EAE  5F 56 4B	MOV	[0x56],[0x4B]
0EB1  5F 57 4A	MOV	[0x57],[0x4A]
0EB4  06 56 6C	ADD	[0x56],0x6C
0EB7  0E 57 00	ADC	[0x57],0x00
0EBA  52 FC	MOV	A,[X+0xFC]
0EBC  3F 56	MVI	[[0x56]++],A
0EBE  52 F8	MOV	A,[X+0xF8]
0EC0  53 57	MOV	[0x57],A
0EC2  52 F9	MOV	A,[X+0xF9]
0EC4  53 56	MOV	[0x56],A
0EC6  52 FA	MOV	A,[X+0xFA]
0EC8  53 55	MOV	[0x55],A
0ECA  52 FB	MOV	A,[X+0xFB]
0ECC  53 54	MOV	[0x54],A
0ECE  50 18	MOV	A,0x18
0ED0  70 FB	AND	F,0xFB
0ED2  6E 57	RRC	[0x57]
0ED4  6E 56	RRC	[0x56]
0ED6  6E 55	RRC	[0x55]
0ED8  6E 54	RRC	[0x54]
0EDA  78	DEC	A
0EDB  BF F4	JNZ	0x0ED0
0EDD  26 55 00	AND	[0x55],0x00
0EE0  26 56 00	AND	[0x56],0x00
0EE3  26 57 00	AND	[0x57],0x00
0EE6  5F 57 54	MOV	[0x57],[0x54]
0EE9  52 00	MOV	A,[X+0x00]
0EEB  53 54	MOV	[0x54],A
0EED  50 00	MOV	A,0x00
0EEF  08	PUSH	A
0EF0  51 54	MOV	A,[0x54]
0EF2  08	PUSH	A
0EF3  50 00	MOV	A,0x00
0EF5  08	PUSH	A
0EF6  50 05	MOV	A,0x05
0EF8  08	PUSH	A
0EF9  7C 11 57	LCALL	0x1157	; func9
0EFC  38 FC	ADD	SP,0xFC
0EFE  5F 54 4B	MOV	[0x54],[0x4B]
0F01  5F 55 4A	MOV	[0x55],[0x4A]
0F04  06 54 6D	ADD	[0x54],0x6D
0F07  0E 55 00	ADC	[0x55],0x00
0F0A  51 57	MOV	A,[0x57]
0F0C  3F 54	MVI	[[0x54]++],A
0F0E  52 F8	MOV	A,[X+0xF8]
0F10  53 57	MOV	[0x57],A
0F12  52 F9	MOV	A,[X+0xF9]
0F14  53 56	MOV	[0x56],A
0F16  52 FA	MOV	A,[X+0xFA]
0F18  53 55	MOV	[0x55],A
0F1A  52 FB	MOV	A,[X+0xFB]
0F1C  53 54	MOV	[0x54],A
0F1E  50 10	MOV	A,0x10
0F20  70 FB	AND	F,0xFB
0F22  6E 57	RRC	[0x57]
0F24  6E 56	RRC	[0x56]
0F26  6E 55	RRC	[0x55]
0F28  6E 54	RRC	[0x54]
0F2A  78	DEC	A
0F2B  BF F4	JNZ	0x0F20
0F2D  26 55 00	AND	[0x55],0x00
0F30  26 56 00	AND	[0x56],0x00
0F33  26 57 00	AND	[0x57],0x00
0F36  5F 57 54	MOV	[0x57],[0x54]
0F39  52 00	MOV	A,[X+0x00]
0F3B  53 54	MOV	[0x54],A
0F3D  50 00	MOV	A,0x00
0F3F  08	PUSH	A
0F40  51 54	MOV	A,[0x54]
0F42  08	PUSH	A
0F43  50 00	MOV	A,0x00
0F45  08	PUSH	A
0F46  50 05	MOV	A,0x05
0F48  08	PUSH	A
0F49  7C 11 57	LCALL	0x1157	; func9
0F4C  38 FC	ADD	SP,0xFC
0F4E  5F 54 4B	MOV	[0x54],[0x4B]
0F51  5F 55 4A	MOV	[0x55],[0x4A]
0F54  06 54 6E	ADD	[0x54],0x6E
0F57  0E 55 00	ADC	[0x55],0x00
0F5A  51 57	MOV	A,[0x57]
0F5C  3F 54	MVI	[[0x54]++],A
0F5E  52 F8	MOV	A,[X+0xF8]
0F60  53 57	MOV	[0x57],A
0F62  52 F9	MOV	A,[X+0xF9]
0F64  53 56	MOV	[0x56],A
0F66  52 FA	MOV	A,[X+0xFA]
0F68  53 55	MOV	[0x55],A
0F6A  52 FB	MOV	A,[X+0xFB]
0F6C  53 54	MOV	[0x54],A
0F6E  50 08	MOV	A,0x08
0F70  70 FB	AND	F,0xFB
0F72  6E 57	RRC	[0x57]
0F74  6E 56	RRC	[0x56]
0F76  6E 55	RRC	[0x55]
0F78  6E 54	RRC	[0x54]
0F7A  78	DEC	A
0F7B  BF F4	JNZ	0x0F70
0F7D  26 55 00	AND	[0x55],0x00
0F80  26 56 00	AND	[0x56],0x00
0F83  26 57 00	AND	[0x57],0x00
0F86  5F 57 54	MOV	[0x57],[0x54]
0F89  52 00	MOV	A,[X+0x00]
0F8B  53 54	MOV	[0x54],A
0F8D  50 00	MOV	A,0x00
0F8F  08	PUSH	A
0F90  51 54	MOV	A,[0x54]
0F92  08	PUSH	A
0F93  50 00	MOV	A,0x00
0F95  08	PUSH	A
0F96  50 05	MOV	A,0x05
0F98  08	PUSH	A
0F99  7C 11 57	LCALL	0x1157	; func9
0F9C  38 FC	ADD	SP,0xFC
0F9E  5F 54 4B	MOV	[0x54],[0x4B]
0FA1  5F 55 4A	MOV	[0x55],[0x4A]
0FA4  06 54 6F	ADD	[0x54],0x6F
0FA7  0E 55 00	ADC	[0x55],0x00
0FAA  51 57	MOV	A,[0x57]
0FAC  3F 54	MVI	[[0x54]++],A
0FAE  52 FB	MOV	A,[X+0xFB]
0FB0  53 57	MOV	[0x57],A
0FB2  52 00	MOV	A,[X+0x00]
0FB4  53 54	MOV	[0x54],A
0FB6  50 00	MOV	A,0x00
0FB8  08	PUSH	A
0FB9  51 54	MOV	A,[0x54]
0FBB  08	PUSH	A
0FBC  50 00	MOV	A,0x00
0FBE  08	PUSH	A
0FBF  50 05	MOV	A,0x05
0FC1  08	PUSH	A
0FC2  7C 11 57	LCALL	0x1157	; func9
0FC5  38 FC	ADD	SP,0xFC
0FC7  5F 54 4B	MOV	[0x54],[0x4B]
0FCA  5F 55 4A	MOV	[0x55],[0x4A]
0FCD  06 54 70	ADD	[0x54],0x70
0FD0  0E 55 00	ADC	[0x55],0x00
0FD3  51 57	MOV	A,[0x57]
0FD5  3F 54	MVI	[[0x54]++],A
0FD7  52 00	MOV	A,[X+0x00]
0FD9  53 48	MOV	[0x48],A
0FDB  38 FF	ADD	SP,0xFF
0FDD  20	POP	X
0FDE  7F	RET

func73:
0FDF  10	PUSH	X
0FE0  4F	MOV	X,SP
0FE1  38 03	ADD	SP,0x03
0FE3  51 47	MOV	A,[0x47]
0FE5  01 01	ADD	A,0x01
0FE7  54 00	MOV	[X+0x00],A
0FE9  3D 00 03	CMP	[X+0x00],0x03
0FEC  C0 04	JC	0x0FF1
0FEE  56 00 00	MOV	[X+0x00],0x00
0FF1  55 57 6C	MOV	[0x57],0x6C
0FF4  10	PUSH	X
0FF5  52 00	MOV	A,[X+0x00]
0FF7  57 05	MOV	X,0x05
0FF9  7C 11 7A	LCALL	0x117A 	; func10
0FFC  20	POP	X
0FFD  02 57	ADD	A,[0x57]
0FFF  54 02	MOV	[X+0x02],A
1001  52 00	MOV	A,[X+0x00]
1003  53 47	MOV	[0x47],A
1005  52 02	MOV	A,[X+0x02]
1007  53 56	MOV	[0x56],A
1009  52 01	MOV	A,[X+0x01]
100B  53 57	MOV	[0x57],A
100D  38 FD	ADD	SP,0xFD
100F  20	POP	X
1010  7F	RET

func72:
1011  5F 48 47	MOV	[0x48],[0x47]
1014  7F	RET

func19:
1015  10	PUSH	X
1016  4F	MOV	X,SP
1017  38 02	ADD	SP,0x02
1019  51 47	MOV	A,[0x47]
101B  3A 48	CMP	A,[0x48]
101D  B0 09	JNZ	0x1027
101F  56 01 01	MOV	[X+0x01],0x01
1022  56 00 00	MOV	[X+0x00],0x00
1025  80 07	JMP	0x102D
1027  56 01 00	MOV	[X+0x01],0x00
102A  56 00 00	MOV	[X+0x00],0x00
102D  52 01	MOV	A,[X+0x01]
102F  38 FE	ADD	SP,0xFE
1031  20	POP	X
1032  7F	RET

func11:
1033  10	PUSH	X
1034  4F	MOV	X,SP
1035  38 03	ADD	SP,0x03
1037  56 01 00	MOV	[X+0x01],0x00
103A  56 00 00	MOV	[X+0x00],0x00
103D  56 02 00	MOV	[X+0x02],0x00
1040  80 2A	JMP	0x106B
1042  52 FC	MOV	A,[X+0xFC]
1044  21 01	AND	A,0x01
1046  53 56	MOV	[0x56],A
1048  55 57 00	MOV	[0x57],0x00
104B  52 01	MOV	A,[X+0x01]
104D  53 54	MOV	[0x54],A
104F  52 00	MOV	A,[X+0x00]
1051  53 55	MOV	[0x55],A
1053  65 54	ASL	[0x54]
1055  6B 55	RLC	[0x55]
1057  51 54	MOV	A,[0x54]
1059  2A 56	OR	A,[0x56]
105B  54 01	MOV	[X+0x01],A
105D  51 55	MOV	A,[0x55]
105F  2A 57	OR	A,[0x57]
1061  54 00	MOV	[X+0x00],A
1063  70 FB	AND	F,0xFB
1065  6F FB	RRC	[X+0xFB]
1067  6F FC	RRC	[X+0xFC]
1069  77 02	INC	[X+0x02]
106B  3D 02 10	CMP	[X+0x02],0x10
106E  CF D3	JC	0x1042
1070  52 01	MOV	A,[X+0x01]
1072  53 56	MOV	[0x56],A
1074  52 00	MOV	A,[X+0x00]
1076  53 57	MOV	[0x57],A
1078  38 FD	ADD	SP,0xFD
107A  20	POP	X
107B  7F	RET

func12:
107C  10	PUSH	X
107D  4F	MOV	X,SP
107E  52 FC	MOV	A,[X+0xFC]
1080  13 FA	SUB	A,[X+0xFA]
1082  52 FB	MOV	A,[X+0xFB]
1084  1B F9	SBB	A,[X+0xF9]
1086  C0 0F	JC	0x1096
1088  52 F8	MOV	A,[X+0xF8]
108A  13 FC	SUB	A,[X+0xFC]
108C  52 F7	MOV	A,[X+0xF7]
108E  1B FB	SBB	A,[X+0xFB]
1090  C0 05	JC	0x1096
1092  50 01	MOV	A,0x01
1094  80 03	JMP	0x1098
1096  50 00	MOV	A,0x00
1098  20	POP	X
1099  7F	RET

func13:
109A  10	PUSH	X
109B  4F	MOV	X,SP
109C  38 03	ADD	SP,0x03
109E  56 00 00	MOV	[X+0x00],0x00
10A1  3C 94 00	CMP	[0x94],0x00
10A4  B0 05	JNZ	0x10AA
10A6  50 01	MOV	A,0x01
10A8  80 86	JMP	0x112F
10AA  55 54 00	MOV	[0x54],0x00
10AD  55 55 00	MOV	[0x55],0x00
10B0  52 FA	MOV	A,[X+0xFA]
10B2  21 E0	AND	A,0xE0
10B4  53 56	MOV	[0x56],A
10B6  52 F9	MOV	A,[X+0xF9]
10B8  39 87	CMP	A,0x87
10BA  B0 10	JNZ	0x10CB
10BC  3C 56 E0	CMP	[0x56],0xE0
10BF  B0 0B	JNZ	0x10CB
10C1  3C 55 00	CMP	[0x55],0x00
10C4  B0 06	JNZ	0x10CB
10C6  3C 54 00	CMP	[0x54],0x00
10C9  A0 31	JZ	0x10FB
10CB  50 01	MOV	A,0x01
10CD  80 61	JMP	0x112F
10CF  52 FC	MOV	A,[X+0xFC]
10D1  21 01	AND	A,0x01
10D3  55 55 00	MOV	[0x55],0x00
10D6  55 56 00	MOV	[0x56],0x00
10D9  55 57 00	MOV	[0x57],0x00
10DC  3C 57 00	CMP	[0x57],0x00
10DF  B0 0F	JNZ	0x10EF
10E1  3C 56 00	CMP	[0x56],0x00
10E4  B0 0A	JNZ	0x10EF
10E6  3C 55 00	CMP	[0x55],0x00
10E9  B0 05	JNZ	0x10EF
10EB  39 00	CMP	A,0x00
10ED  A0 03	JZ	0x10F1
10EF  77 00	INC	[X+0x00]
10F1  70 FB	AND	F,0xFB
10F3  6F F9	RRC	[X+0xF9]
10F5  6F FA	RRC	[X+0xFA]
10F7  6F FB	RRC	[X+0xFB]
10F9  6F FC	RRC	[X+0xFC]
10FB  3D F9 00	CMP	[X+0xF9],0x00
10FE  BF D0	JNZ	0x10CF
1100  3D FA 00	CMP	[X+0xFA],0x00
1103  BF CB	JNZ	0x10CF
1105  3D FB 00	CMP	[X+0xFB],0x00
1108  BF C6	JNZ	0x10CF
110A  3D FC 00	CMP	[X+0xFC],0x00
110D  BF C1	JNZ	0x10CF
110F  50 02	MOV	A,0x02
1111  08	PUSH	A
1112  52 00	MOV	A,[X+0x00]
1114  08	PUSH	A
1115  7C 11 33	LCALL	0x1133 	; func14
1118  38 FF	ADD	SP,0xFF
111A  18	POP	A
111B  39 00	CMP	A,0x00
111D  A0 09	JZ	0x1127
111F  56 02 01	MOV	[X+0x02],0x01
1122  56 01 00	MOV	[X+0x01],0x00
1125  80 07	JMP	0x112D
1127  56 02 00	MOV	[X+0x02],0x00
112A  56 01 00	MOV	[X+0x01],0x00
112D  52 02	MOV	A,[X+0x02]
112F  38 FD	ADD	SP,0xFD
1131  20	POP	X
1132  7F	RET

func14:
1133  10	PUSH	X
1134  4F	MOV	X,SP
1135  7C 11 3E	LCALL	0x113E	; func15
1138  51 4B	MOV	A,[0x4B]
113A  54 FB	MOV	[X+0xFB],A
113C  20	POP	X
113D  7F	RET

func15:
113E  55 4B 00	MOV	[0x4B],0x00
1141  55 4A 08	MOV	[0x4A],0x08
1144  66 FC	ASL	[X+0xFC]
1146  6B 4B	RLC	[0x4B]
1148  51 4B	MOV	A,[0x4B]
114A  1B FB	SBB	A,[X+0xFB]
114C  C0 05	JC	0x1152
114E  53 4B	MOV	[0x4B],A
1150  77 FC	INC	[X+0xFC]
1152  7A 4A	DEC	[0x4A]
1154  BF EF	JNZ	0x1144
1156  7F	RET

func9:
1157  10	PUSH	X
1158  4F	MOV	X,SP
1159  50 00	MOV	A,0x00
115B  53 4B	MOV	[0x4B],A
115D  53 4A	MOV	[0x4A],A
115F  55 49 10	MOV	[0x49],0x10
1162  6F F9	RRC	[X+0xF9]
1164  6F FA	RRC	[X+0xFA]
1166  D0 09	JNC	0x1170
1168  52 FC	MOV	A,[X+0xFC]
116A  04 4B	ADD	[0x4B],A
116C  52 FB	MOV	A,[X+0xFB]
116E  0C 4A	ADC	[0x4A],A
1170  66 FC	ASL	[X+0xFC]
1172  6C FB	RLC	[X+0xFB]
1174  7A 49	DEC	[0x49]
1176  BF EB	JNZ	0x1162
1178  20	POP	X
1179  7F	RET

func10:
117A  53 4B	MOV	[0x4B],A
117C  5A 4A	MOV	[0x4A],X
117E  50 00	MOV	A,0x00
1180  6E 4B	RRC	[0x4B]
1182  D0 03	JNC	0x1186
1184  02 4A	ADD	A,[0x4A]
1186  65 4A	ASL	[0x4A]
1188  BF F7	JNZ	0x1180
118A  7F	RET

118B  30	HALT
..
11FF  30	HALT

ourhardworkbythesewordsguardedpleasedontsteal:
1200  6F
...
1240  00

1241  00	SSC
1242  00	SSC
1243  20	POP	X
1244  12 64	SUB	A,[0x64]
1246  00	SSC
1247  00	SSC
1248  DE 00	JNC	0x1049
124A  00	SSC
124B  00	SSC
124C  12 12	SUB	A,[0x12]
124E  52 00	MOV	A,[X+0x00]
1250  00	SSC
1251  DE 12	JNC	0x1064
1253  01 00	ADD	A,0x00
1255  02 FF	ADD	A,[0xFF]
1257  00	SSC
1258  00	SSC
1259  08	PUSH	A

usb_vendor_id:
125A  AC 05

usb_product_id:
125C  41 82

125E  44
125F  02 02	ADD	A,[0x02]
1261  01 00	ADD	A,0x00
1263  01 09	ADD	A,0x09
1265  02 20	ADD	A,[0x20]
1267  00	SSC
1268  01 01	ADD	A,0x01
126A  00	SSC
126B  80 32	JMP	0x129E
126D  09 04	ADC	A,0x04
126F  00	SSC
1270  00	SSC
1271  02 00	ADD	A,[0x00]
1273  00	SSC
1274  00	SSC
1275  01 07	ADD	A,0x07
1277  05 81	ADD	[X+0x81],A
1279  03 08	ADD	A,[X+0x08]
127B  00	SSC
127C  0A 07	ADC	A,[0x07]
127E  05 02	ADD	[X+0x02],A
1280  03 08	ADD	A,[X+0x08]
1282  00	SSC
1283  0A 03	ADC	A,[0x03]
1285  00	SSC
1286  00	SSC
1287  04 12	ADD	[0x12],A
1289  A5 00	JZ	0x178A
128B  00	SSC
128C  DE 00	JNC	0x108D
128E  00	SSC
128F  2E 12 A9	OR	[0x12],0xA9
1292  00	SSC
1293  00	SSC
1294  DE 00	JNC	0x1095
1296  00	SSC
1297  2A 12	OR	A,[0x12]
1299  D7 00	JNC	0x199A
129B  00	SSC
129C  DE 00	JNC	0x109D
129E  00	SSC
129F  10	PUSH	X
12A0  13 01	SUB	A,[X+0x01]
12A2  00	SSC
12A3  00	SSC
12A4  DE 04	JNC	0x10A9
12A6  03 09	ADD	A,[X+0x09]
12A8  04 2E	ADD	[0x2E],A
12AA  03 49	ADD	A,[X+0x49]
12AC  00	SSC
12AD  52 00	MOV	A,[X+0x00]
12AF  20	POP	X
12B0  00	SSC
12B1  52 00	MOV	A,[X+0x00]
12B3  65 00	ASL	[0x00]
12B5  63 00 65	MOV	REG[X+0x00],0x65
12B8  00	SSC
12B9  69 00	ASR	[X+0x00]
12BB  76 00	INC	[0x00]
12BD  65 00	ASL	[0x00]
12BF  72 00	XOR	F,0x00
12C1  20	POP	X
12C2  00	SSC
12C3  50 00	MOV	A,0x00
12C5  72 00	XOR	F,0x00
12C7  6F 00	RRC	[X+0x00]
12C9  67	ASR	A
12CA  00	SSC
12CB  72 00	XOR	F,0x00
12CD  61 00	MOV	REG[X+0x00],A
12CF  6D	RRC	A
12D0  00	SSC
12D1  6D	RRC	A
12D2  00	SSC
12D3  65 00	ASL	[0x00]
12D5  72 00	XOR	F,0x00
12D7  2A 03	OR	A,[0x03]
12D9  41 00 70	AND	REG[0x00],0x70 ; P0DATA
12DC  00	SSC
12DD  70 00	AND	F,0x00
12DF  6C 00	RLC	[X+0x00]
12E1  65 00	ASL	[0x00]
12E3  20	POP	X
12E4  00	SSC
12E5  43 00 6F	OR	REG[0x00],0x6F ; P0DATA
12E8  00	SSC
12E9  6D	RRC	A
12EA  00	SSC
12EB  70 00	AND	F,0x00
12ED  75	INC	X
12EE  00	SSC
12EF  74	INC	A
12F0  00	SSC
12F1  65 00	ASL	[0x00]
12F3  72 00	XOR	F,0x00
12F5  2C 00	OR	[0x00],A
12F7  20	POP	X
12F8  00	SSC
12F9  49 00 6E	TST	REG[0x00],0x6E ; P0DATA
12FC  00	SSC
12FD  63 00 2E	MOV	REG[X+0x00],0x2E ; P0DATA
1300  00	SSC
1301  10	PUSH	X
1302  03 56	ADD	A,[X+0x56]
1304  00	SSC
1305  65 00	ASL	[0x00]
1307  72 00	XOR	F,0x00
1309  20	POP	X
130A  00	SSC
130B  31 00	XOR	A,0x00
130D  2E 00 30	OR	[0x00],0x30
1310  00	SSC
1311  30	HALT
1312  30	HALT
1313  30	HALT

flashWriteLite:
1314  5D 30	MOV	A,REG[0x30]
1316  08	PUSH	A
1317  21 FE	AND	A,0xFE
1319  60 30	MOV	REG[0x30],A
131B  71 10	OR	F,0x10
131D  5D E0	MOV	A,REG[0xE0]
131F  08	PUSH	A
1320  21 F8	AND	A,0xF8
1322  29 02	OR	A,0x02
1324  60 E0	MOV	REG[0xE0],A
1326  70 EF	AND	F,0xEF
1328  4F	MOV	X,SP
1329  52 FA	MOV	A,[X+0xFA]
132B  53 FA	MOV	[0xFA],A
132D  26 FA 7F	AND	[0xFA],0x7F
1330  55 FC 15	MOV	[0xFC],0x15
1333  55 FE 56	MOV	[0xFE],0x56
1336  4F	MOV	X,SP
1337  5B	MOV	A,X
1338  01 03	ADD	A,0x03
133A  53 F9	MOV	[0xF9],A
133C  55 F8 3A	MOV	[0xF8],0x3A ; key1
133F  50 03	MOV	A,0x03
1341  00	SSC		; EraseBlock
1342  3C F8 00	CMP	[0xF8],0x00
1345  A0 05	JZ	0x134B
1347  50 02	MOV	A,0x02
1349  80 2A	JMP	0x1374
134B  4F	MOV	X,SP
134C  52 FA	MOV	A,[X+0xFA]
134E  53 FA	MOV	[0xFA],A
1350  26 FA 7F	AND	[0xFA],0x7F
1353  52 FB	MOV	A,[X+0xFB]
1355  53 FB	MOV	[0xFB],A
1357  55 FC 55	MOV	[0xFC],0x55
135A  55 FE 56	MOV	[0xFE],0x56
135D  4F	MOV	X,SP
135E  5B	MOV	A,X
135F  01 03	ADD	A,0x03
1361  53 F9	MOV	[0xF9],A
1363  55 F8 3A	MOV	[0xF8],0x3A ; key1
1366  50 02	MOV	A,0x02
1368  00	SSC		; WriteBlock
1369  3C F8 00	CMP	[0xF8],0x00
136C  A0 05	JZ	0x1372
136E  50 03	MOV	A,0x03
1370  80 03	JMP	0x1374
1372  50 00	MOV	A,0x00
1374  4B	SWAP	A,X
1375  18	POP	A
1376  71 10	OR	F,0x10
1378  60 E0	MOV	REG[0xE0],A
137A  70 EF	AND	F,0xEF
137C  18	POP	A
137D  60 30	MOV	REG[0x30],A
137F  4B	SWAP	A,X
1380  7F	RET

bootResetIsr:
1381  3C 00 95	CMP	[0x00],0x95 ; SIGNATURE0
1384  B0 0B	JNZ	0x1390
1386  3C 01 25	CMP	[0x01],0x25 ; SIGNATURE1
1389  B0 06	JNZ	0x1390
138B  76 B0	INC	[0xB0]
138D  7D 16 E5	LJMP	0x16E5	; _USB_RESET_ISR

UserResetIsr:
1390  7D 00 A8	LJMP	0x00A8	; userUsbReset

bootEp0Isr:
1393  3C 00 95	CMP	[0x00],0x95 ; SIGNATURE0
1396  B0 09	JNZ	0x13A0
1398  3C 01 25	CMP	[0x01],0x25 ; SIGNATURE1
139B  B0 04	JNZ	0x13A0
139D  7D 19 A6	LJMP	0x19A6	; _USB_EP0_ISR

UserEp0Isr:
13A0  7D 00 9C	LJMP	0x009C 	; userUsbEp0

bootEp1Isr:
13A3  3C 00 95	CMP	[0x00],0x95
13A6  B0 0B	JNZ	0x13B2
13A8  3C 01 25	CMP	[0x01],0x25
13AB  B0 06	JNZ	0x13B2
13AD  76 B1	INC	[0xB1]
13AF  7D 16 CF	LJMP	0x16CF	; _USB_EP1_ISR

UserEp1Isr:
13B2  7D 00 A0	LJMP	0x00A0	; userUsbEp1

bootEp2Isr:
13B5  3C 00 95	CMP	[0x00],0x95
13B8  B0 0B	JNZ	0x13C4
13BA  3C 01 25	CMP	[0x01],0x25
13BD  B0 06	JNZ	0x13C4
13BF  76 B2	INC	[0xB2]
13C1  7D 16 DA	LJMP	0x16DA 	; _USB_EP2_ISR

UserEp2Isr:
13C4  7D 00 A4	LJMP	0x00A4	; userUsbEp2

bootUsbActivity:
13C7  3C 00 95	CMP	[0x00],0x95 ; SIGNATURE0
13CA  B0 07	JNZ	0x13D2	; UserActivityIsr
13CC  3C 01 25	CMP	[0x01],0x25 ; SIGNATURE1
13CF  B0 02	JNZ	0x13D2	; UserActivityIsr
13D1  7E	RETI

UserActivityIsr:
13D2  7D 00 AC	LJMP	0x00AC 	; userUsbActivity

_EnterBootloader:
13D5  70 FE	AND	F,0xFE
13D7  62 E3 00	MOV	REG[0xE3],0x00
13DA  55 00 95	MOV	[0x00],0x95 ; SIGNATURE0
13DD  55 01 25	MOV	[0x01],0x25 ; SIGNATURE1
13E0  70 00	AND	F,0x00
13E2  7D 13 E8	LJMP	0x13E8	; bootLoaderSoftBoot

bootLoaderVerify:
13E5  7C 1E F5	LCALL	0x1EF5 	; bootCustomCode

bootLoaderSoftBoot:
13E8  55 BA 00	MOV	[0xBA],0x00 ; bootErrorCode
13EB  55 B0 00	MOV	[0xB0],0x00 ; GbResetISR

13EE  3C 00 95	CMP	[0x00],0x95 ; SIGNATURE0
13F1  B0 08	JNZ	0x13FA	    ; DoFlashVerify
13F3  3C 01 25	CMP	[0x01],0x25 ; SIGNATURE1
13F6  B0 03	JNZ	0x13FA	    ; DoFlashVerify
13F8  80 21	JMP	0x141A	    ; bootLoaderStart

DoFlashVerify:
13FA  7C 15 CB	LCALL	0x15CB	    ; bootVerifyFlashChecksum
13FD  47 BA 02	TST	[0xBA],0x02 ; bootErrorCode
1400  B0 19	JNZ	0x141A	; bootLoaderStart
1402  7D 00 E4	LJMP	0x00E4	; __Start

bootDelay:
1405  53 B9	MOV	[0xB9],A ; bootTimeoutDelay
1407  41 DA BF	AND	REG[0xDA],0xBF

bootDelayLoop:
140A  62 E3 00	MOV	REG[0xE3],0x00
140D  49 DA 40	TST	REG[0xDA],0x40
1410  AF F9	JZ	0x140A 	; bootDelayLoop
1412  41 DA BF	AND	REG[0xDA],0xBF
1415  7A B9	DEC	[0xB9]	; bootTimeoutDelay
1417  BF F2	JNZ	0x140A
1419  7F	RET

bootLoaderStart:
141A  70 FE	AND	F,0xFE
141C  62 E3 00	MOV	REG[0xE3],0x00
141F  55 B0 00	MOV	[0xB0],0x00
1422  55 00 00	MOV	[0x00],0x00 ; BootSignature
1425  55 01 00	MOV	[0x01],0x00 ; BootSignature+1
1428  50 C3	MOV	A,0xC3
142A  4E	SWAP	A,SP
142B  71 10	OR	F,0x10
142D  62 E0 12	MOV	REG[0xE0],0x12
1430  70 EF	AND	F,0xEF

1432  50 08	MOV	A,0x08
1434  9F CF	CALL	0x1405	; bootDelay

1436  7C 1D E8	LCALL	0x1DE8	; USB_Stop
1439  62 DE 00	MOV	REG[0xDE],0x00
143C  62 DF 00	MOV	REG[0xDF],0x00
143F  62 E1 00	MOV	REG[0xE1],0x00
1442  62 E0 00	MOV	REG[0xE0],0x00
1445  62 DC 00	MOV	REG[0xDC],0x00
1448  62 DB 00	MOV	REG[0xDB],0x00
144B  62 DA 00	MOV	REG[0xDA],0x00
144E  62 E2 00	MOV	REG[0xE2],0x00
1451  55 00 95	MOV	[0x00],0x95 ; SIGNATURE0
1454  55 01 25	MOV	[0x01],0x25 ; SIGNATURE1

1457  50 02	MOV	A,0x02
1459  9F AA	CALL	0x1405	; bootDelay

145B  71 01	OR	F,0x01
145D  92 56	CALL	0x16B5	; InitializeUsb
145F  55 BA 00	MOV	[0xBA],0x00
1462  55 B9 00	MOV	[0xB9],0x00
1465  50 40	MOV	A,0x40
1467  91 CC	CALL	0x1635 	; InitializeUsb
1469  3C 30 FF	CMP	[0x30],0xFF
146C  A0 06	JZ	0x1473
146E  2E BA 40	OR	[0xBA],0x40 ; bootErrorCode
1471  80 18	JMP	0x148A
1473  3C 31 38	CMP	[0x31],0x38
1476  A0 06	JZ	0x147D
1478  2E BA 80	OR	[0xBA],0x80
147B  80 0E	JMP	0x148A
147D  91 03	CALL	0x1582	; bootVerifyBootLoaderKey
147F  47 BA 40	TST	[0xBA],0x40
1482  B0 07	JNZ	0x148A
1484  26 BA EF	AND	[0xBA],0xEF
1487  7D 14 92	LJMP	0x1492
148A  91 F8	CALL	0x1684
148C  55 BA 00	MOV	[0xBA],0x00
148F  7D 14 62	LJMP	0x1462
1492  26 BA FD	AND	[0xBA],0xFD
1495  2E BA 20	OR	[0xBA],0x20
1498  91 FA	CALL	0x1694
149A  55 B9 28	MOV	[0xB9],0x28
149D  50 40	MOV	A,0x40
149F  91 94	CALL	0x1635
14A1  90 47	CALL	0x14EA
14A3  91 EF	CALL	0x1694
14A5  47 BA 08	TST	[0xBA],0x08
14A8  B0 12	JNZ	0x14BB	; ExecuteSwReset
14AA  47 BA 02	TST	[0xBA],0x02
14AD  B0 0D	JNZ	0x14BB	; ExecuteSwReset
14AF  47 BA 40	TST	[0xBA],0x40
14B2  B0 08	JNZ	0x14BB	; ExecuteSwReset
14B4  47 BA 01	TST	[0xBA],0x01
14B7  AF E2	JZ	0x149A
14B9  80 01	JMP	0x14BB	; ExecuteSwReset

ExecuteSwReset:
14BB  70 FE	AND	F,0xFE
14BD  62 E3 38	MOV	REG[0xE3],0x38
14C0  70 EF	AND	F,0xEF
14C2  62 DE 00	MOV	REG[0xDE],0x00
14C5  62 DF 00	MOV	REG[0xDF],0x00
14C8  62 E1 00	MOV	REG[0xE1],0x00
14CB  62 E0 00	MOV	REG[0xE0],0x00
14CE  62 DC 00	MOV	REG[0xDC],0x00
14D1  62 DB 00	MOV	REG[0xDB],0x00
14D4  62 DA 00	MOV	REG[0xDA],0x00
14D7  7C 1D E8	LCALL	0x1DE8 	; USB_Stop
14DA  57 00	MOV	X,0x00

clear_memory_loop:
14DC  62 E3 00	MOV	REG[0xE3],0x00
14DF  56 00 00	MOV	[X+0x00],0x00
14E2  75	INC	X
14E3  BF F8	JNZ	0x14DC	; clear_memory_loop
14E5  7D 13 E8	LJMP	0x13E8 	; bootLoaderSoftBoot

bootLoaderTimeOut:
14E8  8F D2	JMP	0x14BB	; ExecuteSwReset

bootProcessFlashPage:
14EA  62 E3 38	MOV	REG[0xE3],0x38
14ED  5F C1 3A	MOV	[0xC1],[0x3A] ; bootBlockId, bootRamBuffer+10
14F0  5F C2 3B	MOV	[0xC2],[0x3B]
14F3  5F B8 31	MOV	[0xB8],[0x31]
14F6  90 8A	CALL	0x1582	; bootVerifyBootLoaderKey
14F8  47 BA 40	TST	[0xBA],0x40
14FB  B0 13	JNZ	0x150F
14FD  3C B8 3B	CMP	[0xB8],0x3B
1500  B0 0F	JNZ	0x1510
1502  26 BA FE	AND	[0xBA],0xFE
1505  90 C4	CALL	0x15CB 	; bootVerifyFlashChecksum
1507  47 BA 02	TST	[0xBA],0x02
150A  B0 04	JNZ	0x150F
150C  2E BA 01	OR	[0xBA],0x01
150F  7F	RET

1510  90 A0	CALL	0x15B2
1512  47 BA 10	TST	[0xBA],0x10
1515  BF F9	JNZ	0x150F
1517  47 3C 01	TST	[0x3C],0x01
151A  B0 07	JNZ	0x1522
151C  50 00	MOV	A,0x00
151E  90 1C	CALL	0x153C
1520  80 0E	JMP	0x152F
1522  50 20	MOV	A,0x20
1524  90 16	CALL	0x153C
1526  3C B8 39	CMP	[0xB8],0x39
1529  B0 06	JNZ	0x1530
152B  90 EE	CALL	0x161B
152D  90 24	CALL	0x1553
152F  7F	RET
1530  3C B8 3A	CMP	[0xB8],0x3A
1533  B0 04	JNZ	0x1538
1535  90 1C	CALL	0x1553
1537  7F	RET
1538  2E BA 80	OR	[0xBA],0x80
153B  7F	RET
153C  55 B6 3D	MOV	[0xB6],0x3D
153F  55 B7 70	MOV	[0xB7],0x70
1542  04 B7	ADD	[0xB7],A
1544  55 B4 20	MOV	[0xB4],0x20
1547  62 E3 00	MOV	REG[0xE3],0x00
154A  3E B6	MVI	A,[[0xB6]++]
154C  3F B7	MVI	[[0xB7]++],A
154E  7A B4	DEC	[0xB4]
1550  BF F6	JNZ	0x1547
1552  7F	RET
1553  2E BA 04	OR	[0xBA],0x04
1556  55 B4 40	MOV	[0xB4],0x40
1559  5F BD C2	MOV	[0xBD],[0xC2]
155C  55 BE 00	MOV	[0xBE],0x00
155F  70 FB	AND	F,0xFB
1561  6E BD	RRC	[0xBD]
1563  6E BE	RRC	[0xBE]
1565  6E BD	RRC	[0xBD]
1567  6E BE	RRC	[0xBE]
1569  50 00	MOV	A,0x00
156B  5C	MOV	X,A
156C  10	PUSH	X
156D  51 BD	MOV	A,[0xBD]
156F  58 BE	MOV	X,[0xBE]
1571  28	ROMX
1572  20	POP	X
1573  3B 70	CMP	A,[X+0x70]
1575  B0 0B	JNZ	0x1581
1577  75	INC	X
1578  76 BE	INC	[0xBE]
157A  7A B4	DEC	[0xB4]
157C  BF EF	JNZ	0x156C
157E  26 BA FB	AND	[0xBA],0xFB
1581  7F	RET

bootVerifyBootLoaderKey:
1582  26 BA BF	AND	[0xBA],0xBF ; bootErrorCode, ~INVALID_KEY
1585  3C 32 00	CMP	[0x32],0x00 ; key1
1588  B0 25	JNZ	0x15AE	    ; bootInvalidBootLoaderKey
158A  3C 33 01	CMP	[0x33],0x01 ; key2
158D  B0 20	JNZ	0x15AE
158F  3C 34 02	CMP	[0x34],0x02 ; key3
1592  B0 1B	JNZ	0x15AE
1594  3C 35 03	CMP	[0x35],0x03 ; key4
1597  B0 16	JNZ	0x15AE
1599  3C 36 04	CMP	[0x36],0x04 ; key5
159C  B0 11	JNZ	0x15AE
159E  3C 37 05	CMP	[0x37],0x05 ; key6
15A1  B0 0C	JNZ	0x15AE
15A3  3C 38 06	CMP	[0x38],0x06 ; key7
15A6  B0 07	JNZ	0x15AE
15A8  3C 39 07	CMP	[0x39],0x07 ; key8
15AB  B0 02	JNZ	0x15AE
15AD  7F	RET

bootInvalidBootLoaderKey:
15AE  2E BA 40	OR	[0xBA],0x40
15B1  7F	RET

bootVerifyPacketChecksum:
15B2  2E BA 10	OR	[0xBA],0x10
15B5  57 30	MOV	X,0x30	; bootRamBuffer
15B7  55 B4 2D	MOV	[0xB4],0x2D
15BA  50 00	MOV	A,0x00

bootAddNextByteOfPacket:
15BC  03 00	ADD	A,[X+0x00]
15BE  75	INC	X
15BF  7A B4	DEC	[0xB4]
15C1  BF FA	JNZ	0x15BC	; bootAddNextByteOfPacket

15C3  3B 00	CMP	A,[X+0x00]
15C5  B0 04	JNZ	0x15CA	; bootCheckSumError

bootChecksumOk:
15C7  26 BA EF	AND	[0xBA],0xEF

bootCheckSumError:
15CA  7F	RET

bootVerifyFlashChecksum:
15CB  26 BA FD	AND	[0xBA],0xFD
15CE  55 BD 00	MOV	[0xBD],0x00
15D1  55 BE 80	MOV	[0xBE],0x80
15D4  55 BF 00	MOV	[0xBF],0x00
15D7  55 C0 46	MOV	[0xC0],0x46
15DA  55 BB 00	MOV	[0xBB],0x00
15DD  55 BC 00	MOV	[0xBC],0x00
15E0  55 B4 40	MOV	[0xB4],0x40
15E3  62 E3 00	MOV	REG[0xE3],0x00
15E6  51 BD	MOV	A,[0xBD]
15E8  58 BE	MOV	X,[0xBE]
15EA  28	ROMX
15EB  04 BC	ADD	[0xBC],A
15ED  0E BB 00	ADC	[0xBB],0x00
15F0  06 BE 01	ADD	[0xBE],0x01
15F3  0E BD 00	ADC	[0xBD],0x00
15F6  7A B4	DEC	[0xB4]
15F8  BF EA	JNZ	0x15E3
15FA  16 C0 01	SUB	[0xC0],0x01
15FD  BF E2	JNZ	0x15E0
15FF  1E BF 00	SBB	[0xBF],0x00
1602  BF DD	JNZ	0x15E0
1604  57 FE	MOV	X,0xFE
1606  50 1F	MOV	A,0x1F
1608  28	ROMX
1609  3A BB	CMP	A,[0xBB]
160B  B0 0B	JNZ	0x1617
160D  57 FF	MOV	X,0xFF
160F  50 1F	MOV	A,0x1F
1611  28	ROMX
1612  3A BC	CMP	A,[0xBC]
1614  B0 02	JNZ	0x1617
1616  7F	RET
1617  2E BA 02	OR	[0xBA],0x02
161A  7F	RET

bootFlashWrite:
161B  70 FE	AND	F,0xFE
161D  26 BA F7	AND	[0xBA],0xF7
1620  51 C2	MOV	A,[0xC2]
1622  08	PUSH	A
1623  50 70	MOV	A,0x70
1625  08	PUSH	A
1626  7C 13 14	LCALL	0x1314	; flashWriteLite
1629  38 FE	ADD	SP,0xFE
162B  39 00	CMP	A,0x00
162D  A0 04	JZ	0x1632
162F  2E BA 08	OR	[0xBA],0x08
1632  71 01	OR	F,0x01
1634  7F	RET

ReadEp2:
1635  53 B4	MOV	[0xB4],A ; bootByteCount
1637  55 B7 30	MOV	[0xB7],0x30 ; bootDestPointer, bootRamBuffer
163A  41 DA BF	AND	REG[0xDA],0xBF

ep2NextPacket:
163D  55 B2 00	MOV	[0xB2],0x00 ; bEp2Count
1640  50 02	MOV	A,0x02
1642  7C 1E 81	LCALL	0x1E81	; USB_EnableOutEP

ep2WaitData:
1645  62 E3 00	MOV	REG[0xE3],0x00
1648  51 B0	MOV	A,[0xB0] ; GbResetISR
164A  BD CF	JNZ	0x141A
164C  51 B2	MOV	A,[0xB2] ; bEp2Count
164E  B0 13	JNZ	0x1662
1650  51 B9	MOV	A,[0xB9]
1652  AF F2	JZ	0x1645
1654  49 DA 40	TST	REG[0xDA],0x40
1657  AF ED	JZ	0x1645
1659  41 DA BF	AND	REG[0xDA],0xBF
165C  7A B9	DEC	[0xB9]
165E  BF E6	JNZ	0x1645 	; ep2WaitData
1660  8E 87	JMP	0x14E8	; bootLoaderTimeOut

ep2DataAvail:
1662  50 02	MOV	A,0x02
1664  7C 1E 2A	LCALL	0x1E2A	; USB_bGetEPCount
1667  53 B3	MOV	[0xB3],A
1669  3A B4	CMP	A,[0xB4]
166B  C0 04	JC	0x1670
166D  5F B3 B4	MOV	[0xB3],[0xB4]

ep2LoopInit:
1670  57 00	MOV	X,0x00

nextEp2Loop:
1672  62 E3 00	MOV	REG[0xE3],0x00
1675  5E 60	MOV	A,REG[X+0x60]
1677  3F B7	MVI	[[0xB7]++],A
1679  75	INC	X
167A  7A B3	DEC	[0xB3]
167C  BF F5	JNZ	0x1672
167E  5B	MOV	A,X
167F  14 B4	SUB	[0xB4],A
1681  BF BB	JNZ	0x163D 	; ep2NextPacket
1683  7F	RET

WriteErrorCodeToEP1:
1684  55 B1 00	MOV	[0xB1],0x00
1687  55 2D 01	MOV	[0x2D],0x01 ; USB_APIEPNumber
168A  55 2E 01	MOV	[0x2E],0x01 ; USB_APICount
168D  50 BA	MOV	A,0xBA	    ; bootErrorCode
168F  5C	MOV	X,A
1690  7C 1E 3A	LCALL	0x1E3A	; USB_XLoadEP
1693  7F	RET

WriteErrorCodeWait:
1694  9F EE	CALL	0x1684	; WriteErrorCodeToEP1
1696  55 B9 28	MOV	[0xB9],0x28 ; bootTimeoutDelay
1699  41 DA BF	AND	REG[0xDA],0xBF

bootWaitForMasterToReadStatus1:
169C  62 E3 00	MOV	REG[0xE3],0x00
169F  3C B9 00	CMP	[0xB9],0x00
16A2  A0 0D	JZ	0x16B0
16A4  49 DA 40	TST	REG[0xDA],0x40
16A7  A0 08	JZ	0x16B0
16A9  41 DA BF	AND	REG[0xDA],0xBF
16AC  7A B9	DEC	[0xB9]
16AE  AE 39	JZ	0x14E8	; bootLoaderTimeOut

CheckEp1Count1:
16B0  51 B1	MOV	A,[0xB1] ; bEp1Count
16B2  AF E9	JZ	0x169C	 ; bootWaitForMasterToReadStatus1
16B4  7F	RET

InitializeUsb:
16B5  50 FF	MOV	A,0xFF
16B7  7C 1D C4	LCALL	0x1DC4	;USB_Start

WaitForEnumeration:
16BA  62 E3 00	MOV	REG[0xE3],0x00
16BD  7C 1E 0F	LCALL	0x1E0F	; USB_bGetConfiguration
16C0  AF F9	JZ	0x16BA	; WaitForEnumeration
16C2  55 B1 00	MOV	[0xB1],0x00 ; bEp1Count
16C5  55 B2 00	MOV	[0xB2],0x00 ; bEp2Count
16C8  55 B0 00	MOV	[0xB0],0x00 ; GbResetISR
16CB  43 E1 06	OR	REG[0xE1],0x06
16CE  7F	RET

_USB_EP1_ISR:
16CF  08	PUSH	A
16D0  36 1D 02	XOR	[0x1D],0x02 ; datatoggle
16D3  5D 45	MOV	A,REG[0x45]
16D5  55 23 01	MOV	[0x23],0x01 ; endpointapistatus1, EVENT_PENDING
16D8  18	POP	A
16D9  7E	RETI

_USB_EP2_ISR:
16DA  08	PUSH	A
16DB  36 1D 04	XOR	[0x1D],0x04 ; datatoggle
16DE  5D 46	MOV	A,REG[0x46]
16E0  55 24 01	MOV	[0x24],0x01 ; endpointapistatus2, EVENT_PENDING
16E3  18	POP	A
16E4  7E	RETI

_USB_RESET_ISR:
16E5  08	PUSH	A
16E6  10	PUSH	X
16E7  51 02	MOV	A,[0x02] ; bCurrentDevice
16E9  7C 1D C4	LCALL	0x1DC4	; USB_Start
16EC  20	POP	X
16ED  18	POP	A
16EE  7E	RETI

userUsbActivity:
_USB_ACT_ISR:
16EF  55 2F 01	MOV	[0x2F],0x01 ; bActivity
16F2  41 E1 EF	AND	REG[0xE1],0xEF
16F5  7E	RETI

ep0_stall:
16F6  50 00	MOV	A,0x00
16F8  57 03	MOV	X,0x03
16FA  7D 19 B5	LJMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

16FD  00	SSC
16FE  01 00	ADD	A,0x00
1700  02 00	ADD	A,[0x00]
1702  0C 00	ADC	[0x00],A
1704  00	SSC
1705  DE 55	JNC	0x155B
1707  1F 00 55	SBB	[X+0x00],0x55
170A  0D 00	ADC	[X+0x00],A
170C  5F 0C 04	MOV	[0x0C],[0x04]
170F  50 16	MOV	A,0x16
1711  57 FD	MOV	X,0xFD
1713  82 8C	JMP	0x19A0

1715  5D 53	MOV	A,REG[0x53]
1717  64	ASL	A
1718  39 08	CMP	A,0x08
171A  DF DB	JNC	0x16F6	; ep0_stall
171C  E0 01	JACC	0x171E

171E  8F D7	JMP	0x16F6	; ep0_stall
1720  80 36	JMP	0x1757
1722  80 03	JMP	0x1726
1724  80 50	JMP	0x1775

1726  3C 02 FF	CMP	[0x02],0xFF
1729  B0 0A	JNZ	0x1734
172B  55 1F 00	MOV	[0x1F],0x00
172E  50 12	MOV	A,0x12
1730  57 40	MOV	X,0x40
1732  82 6D	JMP	0x19A0
1734  94 4B	CALL	0x1B81
1736  4B	SWAP	A,X
1737  01 02	ADD	A,0x02
1739  4B	SWAP	A,X
173A  09 00	ADC	A,0x00
173C  55 1F 20	MOV	[0x1F],0x20
173F  94 22	CALL	0x1B63	; USB_GETWORD
1741  51 20	MOV	A,[0x20]
1743  58 21	MOV	X,[0x21]
1745  08	PUSH	A
1746  5D 52	MOV	A,REG[0x52]
1748  53 1F	MOV	[0x1F],A
174A  18	POP	A
174B  08	PUSH	A
174C  28	ROMX
174D  3A 1F	CMP	A,[0x1F]
174F  D0 04	JNC	0x1754
1751  18	POP	A
1752  8F A3	JMP	0x16F6	; ep0_stall
1754  18	POP	A
1755  82 4A	JMP	0x19A0
1757  3C 02 FF	CMP	[0x02],0xFF
175A  B0 0A	JNZ	0x1765
175C  55 1F 00	MOV	[0x1F],0x00
175F  50 12	MOV	A,0x12
1761  57 49	MOV	X,0x49
1763  82 3C	JMP	0x19A0
1765  5F 1F 02	MOV	[0x1F],[0x02]
1768  50 01	MOV	A,0x01
176A  94 08	CALL	0x1B74	; USB_GET_TABLE_PTR
176C  08	PUSH	A
176D  28	ROMX
176E  3A 1F	CMP	A,[0x1F]
1770  18	POP	A
1771  CF 84	JC	0x16F6	; ep0_stall
1773  82 2C	JMP	0x19A0
1775  5D 52	MOV	A,REG[0x52]
1777  53 1F	MOV	[0x1F],A
1779  50 12	MOV	A,0x12
177B  57 84	MOV	X,0x84
177D  3C 02 FF	CMP	[0x02],0xFF
1780  A0 05	JZ	0x1786
1782  50 02	MOV	A,0x02
1784  93 EE	CALL	0x1B74	; USB_GET_TABLE_PTR
1786  08	PUSH	A
1787  28	ROMX
1788  3A 1F	CMP	A,[0x1F]
178A  18	POP	A
178B  CF 6A	JC	0x16F6	; ep0_stall
178D  82 12	JMP	0x19A0
178F  00	SSC
1790  01 00	ADD	A,0x00
1792  01 00	ADD	A,0x00
1794  03 00	ADD	A,[X+0x00]
1796  00	SSC
1797  DE 55	JNC	0x15ED
1799  1F 00 50	SBB	[X+0x00],0x50
179C  17 57 8F	SUB	[X+0x57],0x8F
179F  82 00	JMP	0x19A0
17A1  5D 52	MOV	A,REG[0x52]
17A3  39 01	CMP	A,0x01
17A5  BF 50	JNZ	0x16F6	; ep0_stall
17A7  26 04 FD	AND	[0x04],0xFD
17AA  81 F8	JMP	0x19A3
17AC  5D 52	MOV	A,REG[0x52]
17AE  39 01	CMP	A,0x01
17B0  A0 07	JZ	0x17B8
17B2  39 02	CMP	A,0x02
17B4  A0 08	JZ	0x17BD
17B6  8F 3F	JMP	0x16F6	; ep0_stall
17B8  2E 04 02	OR	[0x04],0x02
17BB  80 03	JMP	0x17BF
17BD  8F 38	JMP	0x16F6	; ep0_stall
17BF  81 E3	JMP	0x19A3

ep0_set_address:
17C1  55 1E 01	MOV	[0x1E],0x01
17C4  5D 52	MOV	A,REG[0x52] ; address
17C6  53 0C	MOV	[0x0C],A    ; address
17C8  81 DA	JMP	0x19A3	    ; func40

ep0_set_configuration:
17CA  93 B5	CALL	0x1B81
17CC  55 1F 20	MOV	[0x1F],0x20
17CF  93 92	CALL	0x1B63	; USB_GETWORD
17D1  5D 52	MOV	A,REG[0x52]
17D3  53 1F	MOV	[0x1F],A
17D5  51 20	MOV	A,[0x20]
17D7  58 21	MOV	X,[0x21]
17D9  28	ROMX
17DA  3A 1F	CMP	A,[0x1F]
17DC  CF 19	JC	0x16F6	; ep0_stall
17DE  5F 03 1F	MOV	[0x03],[0x1F]
17E1  3C 1F 00	CMP	[0x1F],0x00
17E4  A0 25	JZ	0x180A
17E6  51 20	MOV	A,[0x20]
17E8  58 21	MOV	X,[0x21]
17EA  75	INC	X
17EB  09 00	ADC	A,0x00
17ED  55 1F 20	MOV	[0x1F],0x20
17F0  93 71	CALL	0x1B63	; USB_GETWORD
17F2  57 00	MOV	X,0x00
17F4  75	INC	X
17F5  10	PUSH	X
17F6  51 20	MOV	A,[0x20]
17F8  58 21	MOV	X,[0x21]
17FA  28	ROMX
17FB  76 21	INC	[0x21]
17FD  0E 20 00	ADC	[0x20],0x00
1800  20	POP	X
1801  90 AC	CALL	0x18AF
1803  5B	MOV	A,X
1804  39 02	CMP	A,0x02
1806  BF ED	JNZ	0x17F4
1808  80 0C	JMP	0x1815
180A  57 02	MOV	X,0x02
180C  56 22 02	MOV	[X+0x22],0x02
180F  63 44 00	MOV	REG[X+0x44],0x00
1812  79	DEC	X
1813  BF F8	JNZ	0x180C
1815  81 8D	JMP	0x19A3
1817  00	SSC
1818  01 00	ADD	A,0x00
181A  02 00	ADD	A,[0x00]
181C  0C 00	ADC	[0x00],A
181E  00	SSC
181F  DE 55	JNC	0x1675
1821  0C 00	ADC	[0x00],A
1823  55 0D 00	MOV	[0x0D],0x00
1826  55 1F 00	MOV	[0x1F],0x00
1829  50 18	MOV	A,0x18
182B  57 17	MOV	X,0x17
182D  81 72	JMP	0x19A0
182F  00	SSC
1830  01 00	ADD	A,0x00
1832  01 00	ADD	A,0x00
1834  0C 00	ADC	[0x00],A
1836  00	SSC
1837  DE 5D	JNC	0x1695
1839  54 39	MOV	[X+0x39],A
183B  02 DE	ADD	A,[0xDE]
183D  B9 5C	JNZ	0x119A
183F  52 05	MOV	A,[X+0x05]
1841  53 0C	MOV	[0x0C],A
1843  55 1F 00	MOV	[0x1F],0x00
1846  50 18	MOV	A,0x18
1848  57 2F	MOV	X,0x2F
184A  81 55	JMP	0x19A0
184C  5D 54	MOV	A,REG[0x54]
184E  21 7F	AND	A,0x7F
1850  39 03	CMP	A,0x03
1852  DE A3	JNC	0x16F6	; ep0_stall
1854  5C	MOV	X,A
1855  55 1F 00	MOV	[0x1F],0x00
1858  55 0D 00	MOV	[0x0D],0x00
185B  52 07	MOV	A,[X+0x07]
185D  53 0C	MOV	[0x0C],A
185F  50 16	MOV	A,0x16
1861  57 FD	MOV	X,0xFD
1863  81 3C	JMP	0x19A0
1865  5D 52	MOV	A,REG[0x52]
1867  39 00	CMP	A,0x00
1869  BE 8C	JNZ	0x16F6	; ep0_stall
186B  5D 54	MOV	A,REG[0x54]
186D  21 7F	AND	A,0x7F
186F  39 00	CMP	A,0x00
1871  A0 16	JZ	0x1888
1873  39 03	CMP	A,0x03
1875  DE 80	JNC	0x16F6	; ep0_stall
1877  5C	MOV	X,A
1878  27 07 FE	AND	[X+0x07],0xFE
187B  49 54 80	TST	REG[0x54],0x80
187E  B0 06	JNZ	0x1885
1880  63 44 08	MOV	REG[X+0x44],0x08
1883  80 04	JMP	0x1888
1885  63 44 0C	MOV	REG[X+0x44],0x0C
1888  81 1A	JMP	0x19A3
188A  5D 52	MOV	A,REG[0x52]
188C  39 00	CMP	A,0x00
188E  BE 67	JNZ	0x16F6	; ep0_stall
1890  5D 54	MOV	A,REG[0x54]
1892  21 7F	AND	A,0x7F
1894  39 00	CMP	A,0x00
1896  A0 16	JZ	0x18AD
1898  39 03	CMP	A,0x03
189A  DE 5B	JNC	0x16F6	; ep0_stall
189C  5C	MOV	X,A
189D  2F 07 01	OR	[X+0x07],0x01
18A0  49 54 80	TST	REG[0x54],0x80
18A3  B0 06	JNZ	0x18AA
18A5  63 44 89	MOV	REG[X+0x44],0x89
18A8  80 04	JMP	0x18AD
18AA  63 44 8D	MOV	REG[X+0x44],0x8D
18AD  80 F5	JMP	0x19A3
18AF  39 7F	CMP	A,0x7F
18B1  B0 02	JNZ	0x18B4
18B3  7F	RET

18B4  08	PUSH	A
18B5  5B	MOV	A,X
18B6  64	ASL	A
18B7  E0 01	JACC	0x18B9
18B9  80 05	JMP	0x18BF
18BB  80 08	JMP	0x18C4
18BD  80 0B	JMP	0x18C9

18BF  43 E1 01	OR	REG[0xE1],0x01
18C2  80 09	JMP	0x18CC
18C4  43 E1 02	OR	REG[0xE1],0x02
18C7  80 04	JMP	0x18CC
18C9  43 E1 04	OR	REG[0xE1],0x04
18CC  5B	MOV	A,X
18CD  F4 F2	INDEX	0x1DC1
18CF  31 FF	XOR	A,0xFF
18D1  24 1D	AND	[0x1D],A
18D3  18	POP	A
18D4  21 80	AND	A,0x80
18D6  B0 08	JNZ	0x18DF
18D8  63 44 08	MOV	REG[X+0x44],0x08
18DB  56 22 00	MOV	[X+0x22],0x00
18DE  7F	RET
18DF  63 44 0C	MOV	REG[X+0x44],0x0C
18E2  56 22 01	MOV	[X+0x22],0x01
18E5  7F	RET

jumptable_ep0_handle_in_std_dev:
18E6  8E 1F	JMP	0x1706	; GET_STATUS
18E8  8E 0D	JMP	0x16F6	; CLEAR_FEATURE, ep0_stall
18EA  8E 0B	JMP	0x16F6	; reserved, ep0_stall
18EC  8E 09	JMP	0x16F6	; SET_FEATURE, ep0_stall
18EE  8E 07	JMP	0x16F6	; reserved, ep0_stall
18F0  8E 05	JMP	0x16F6	; SET_ADDRESS, ep0_stall
18F2  8E 22	JMP	0x1715	; GET_DESCRIPTOR
18F4  8E 01	JMP	0x16F6	; SET_DESCRIPTOR, ep0_stall
18F6  8E A1	JMP	0x1798	; GET_CONFIGURATION

ep0_handle_in_std_dev:
18F8  5D 51	MOV	A,REG[0x51]
18FA  39 09	CMP	A,0x09	; SET_CONFIGURATION
18FC  D0 04	JNC	0x1901
18FE  64	ASL	A
18FF  EF E6	JACC	0x18E6	; jumptable_ep0_handle_in_std_dev
1901  8D F4	JMP	0x16F6	; ep0_stall

jumptable_ep0_handle_out_std_dev:
1903  8D F2	JMP	0x16F6	; GET_STATUS, ep0_stall
1905  8E 9B	JMP	0x17A1	; CLEAR_FEATURE
1907  8D EE	JMP	0x16F6	; reserved, ep0_stall
1909  8E A2	JMP	0x17AC	; SET_FEATURE
190B  8D EA	JMP	0x16F6	; reserved, ep0_stall
190D  8E B3	JMP	0x17C1	; SET_ADDRESS
190F  8D E6	JMP	0x16F6	; GET_DESCRIPTOR, ep0_stall
1911  8D E4	JMP	0x16F6	; SET_DESCRIPTOR, ep0_stall
1913  8D E2	JMP	0x16F6	; GET_CONFIGURATION, ep0_stall
1915  8E B4	JMP	0x17CA	; SET_CONFIGURATION

ep0_handle_out_std_dev:
1917  5D 51	MOV	A,REG[0x51]
1919  39 0A	CMP	A,0x0A
191B  D0 04	JNC	0x1920
191D  64	ASL	A
191E  EF E4	JACC	0x1903	; jumptable_ep0_handle_out_std_dev
1920  8D D5	JMP	0x16F6	; ep0_stall

1922  8E FD	JMP	0x1820
1924  8D D1	JMP	0x16F6	; ep0_stall
1926  8D CF	JMP	0x16F6	; ep0_stall
1928  8D CD	JMP	0x16F6	; ep0_stall
192A  8D CB	JMP	0x16F6	; ep0_stall
192C  8D C9	JMP	0x16F6	; ep0_stall
192E  83 08	JMP	0x1C37	; USB_CB_d2h_std_ifc_06
1930  8D C5	JMP	0x16F6	; ep0_stall
1932  8D C3	JMP	0x16F6	; ep0_stall
1934  8D C1	JMP	0x16F6	; ep0_stall
1936  8F 01	JMP	0x1838

1938  3C 03 00	CMP	[0x03],0x00
193B  B0 03	JNZ	0x193F
193D  8D B8	JMP	0x16F6	; ep0_stall
193F  5D 51	MOV	A,REG[0x51]
1941  39 0B	CMP	A,0x0B
1943  D0 04	JNC	0x1948
1945  64	ASL	A
1946  EF DB	JACC	0x1922
1948  8D AD	JMP	0x16F6	; ep0_stall

194A  8D AB	JMP	0x16F6	; ep0_stall

194C  3C 03 00	CMP	[0x03],0x00
194F  B0 03	JNZ	0x1953
1951  8D A4	JMP	0x16F6	; ep0_stall
1953  5D 51	MOV	A,REG[0x51]
1955  39 01	CMP	A,0x01
1957  D0 04	JNC	0x195C
1959  64	ASL	A
195A  EF EF	JACC	0x194A
195C  8D 99	JMP	0x16F6	; ep0_stall

195E  8E ED	JMP	0x184C

1960  3C 03 00	CMP	[0x03],0x00
1963  B0 0D	JNZ	0x1971
1965  5D 55	MOV	A,REG[0x55]
1967  53 1F	MOV	[0x1F],A
1969  5D 54	MOV	A,REG[0x54]
196B  2C 1F	OR	[0x1F],A
196D  A0 03	JZ	0x1971
196F  8D 86	JMP	0x16F6	; ep0_stall
1971  5D 51	MOV	A,REG[0x51]
1973  39 01	CMP	A,0x01
1975  D0 04	JNC	0x197A
1977  64	ASL	A
1978  EF E5	JACC	0x195E
197A  8D 7B	JMP	0x16F6	; ep0_stall

197C  8D 79	JMP	0x16F6	; ep0_stall
197E  8E E6	JMP	0x1865
1980  8D 75	JMP	0x16F6	; ep0_stall
1982  8F 07	JMP	0x188A

1984  3C 03 00	CMP	[0x03],0x00
1987  B0 0D	JNZ	0x1995
1989  5D 55	MOV	A,REG[0x55]
198B  53 1F	MOV	[0x1F],A
198D  5D 54	MOV	A,REG[0x54]
198F  2C 1F	OR	[0x1F],A
1991  A0 03	JZ	0x1995
1993  8D 62	JMP	0x16F6	; ep0_stall
1995  5D 51	MOV	A,REG[0x51]
1997  39 04	CMP	A,0x04
1999  D0 04	JNC	0x199E
199B  64	ASL	A
199C  EF DF	JACC	0x197C
199E  8D 57	JMP	0x16F6	; ep0_stall

19A0  7D 1B 2F	LJMP	0x1B2F	; USB_GetTableEntry

19A3  7D 1A 31	LJMP	0x1A31	; USB_NoDataStageControlTransfer

_USB_EP0_ISR:
19A6  08	PUSH	A
19A7  10	PUSH	X
19A8  5D 44	MOV	A,REG[0x44] ; EP0MODE
19AA  64	ASL	A
19AB  C0 11	JC	0x19BD	; USB_EP0_Setup
19AD  64	ASL	A
19AE  C0 2E	JC	0x19DD	; USB_EP0_IN
19B0  64	ASL	A
19B1  C0 37	JC	0x19E9	; USB_EP0_OUT
19B3  82 65	JMP	0x1C19	; USB_Not_Supported_Local_Drv

USB_EP0_UPD_MODE_EXIT:
19B5  60 41	MOV	REG[0x41],A ; EP0CNT
19B7  5B	MOV	A,X
19B8  60 44	MOV	REG[0x44],A ; EP0MODE
19BA  20	POP	X
19BB  18	POP	A
19BC  7E	RETI

USB_EP0_Setup:
19BD  08	PUSH	A
19BE  50 02	MOV	A,0x02
19C0  91 E7	CALL	0x1BA9	; USB_UpdateStatusBlock
19C2  18	POP	A
19C3  5D 41	MOV	A,REG[0x41] ; EP0CNT
19C5  39 4A	CMP	A,0x4A
19C7  A0 03	JZ	0x19CB
19C9  82 4F	JMP	0x1C19	; USB_Not_Supported_Local_Drv
19CB  5D 50	MOV	A,REG[0x50] ; EP0DATA (bmRequestType)
19CD  21 E3	AND	A,0xE3
19CF  08	PUSH	A
19D0  67	ASR	A
19D1  67	ASR	A
19D2  67	ASR	A	; bmRequestType >> 3
19D3  53 1F	MOV	[0x1F],A
19D5  18	POP	A
19D6  2A 1F	OR	A,[0x1F]
19D8  21 1F	AND	A,0x1F	; dir<<4 | type << 2 | recipient
19DA  7D 1C 10	LJMP	0x1C10	; USB_bmRequestType_Dispatch

USB_EP0_IN:
19DD  51 0B	MOV	A,[0x0B] ; transferType
19DF  E0 01	JACC	0x19E1	 ; USB_ControlInDispatchTable

USB_ControlInDispatchTable:
19E1  82 37	JMP	0x1C19	; USB_Not_Supported_Local_Drv
19E3  80 37	JMP	0x1A1B	; USB_ControlReadDataStage
19E5  80 AD	JMP	0x1A93	; USB_ControlWriteStatusStage
19E7  80 B8	JMP	0x1AA0	; USB_NoDataControlStatusStage

USB_EP0_OUT:
19E9  51 0B	MOV	A,[0x0B] ; transferType
19EB  E0 01	JACC	0x19ED	 ; USB_ControlOutDispatchTable

USB_ControlOutDispatchTable:
19ED  82 2B	JMP	0x1C19	; USB_Not_Supported_Local_Drv
19EF  80 2D	JMP	0x1A1D	; USB_ControlReadStatusStage
19F1  80 5E	JMP	0x1A50	; USB_ControlWriteDataStage
19F3  80 C6	JMP	0x1ABA	; USB_NoDataControlError

USB_InitControlRead:
19F5  53 0A	MOV	[0x0A],A
19F7  91 C6	CALL	0x1BBF	; USB_InitializeStatusBlock
19F9  55 0B 02	MOV	[0x0B],0x02
19FC  5D 57	MOV	A,REG[0x57]
19FE  3A 15	CMP	A,[0x15]
1A00  B0 07	JNZ	0x1A08
1A02  5D 56	MOV	A,REG[0x56]
1A04  3A 16	CMP	A,[0x16]
1A06  A0 09	JZ	0x1A10
1A08  D0 07	JNC	0x1A10
1A0A  53 16	MOV	[0x16],A
1A0C  5D 57	MOV	A,REG[0x57]
1A0E  53 15	MOV	[0x15],A
1A10  55 1B 00	MOV	[0x1B],0x00
1A13  55 1C 00	MOV	[0x1C],0x00
1A16  2E 1D 01	OR	[0x1D],0x01
1A19  80 AA	JMP	0x1AC4	; USB_LoadEndpoint

USB_ControlReadDataStage:
1A1B  80 A8	JMP	0x1AC4	; USB_LoadEndpoint

USB_ControlReadStatusStage:
1A1D  51 0A	MOV	A,[0x0A] ; lastSize
1A1F  04 1C	ADD	[0x1C],A
1A21  0E 1B 00	ADC	[0x1B],0x00
1A24  50 01	MOV	A,0x01
1A26  91 81	CALL	0x1BA9	; USB_UpdateStatusBlock
1A28  55 0B 00	MOV	[0x0B],0x00
1A2B  50 00	MOV	A,0x00
1A2D  57 03	MOV	X,0x03
1A2F  8F 85	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_NoDataStageControlTransfer:
1A31  91 8C	CALL	0x1BBF	; USB_InitializeStatusBlock
1A33  55 0B 06	MOV	[0x0B],0x06
1A36  50 00	MOV	A,0x00
1A38  57 06	MOV	X,0x06
1A3A  8F 7A	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_InitControlWrite:
1A3C  51 14	MOV	A,[0x14] ; DataSource
1A3E  39 00	CMP	A,0x00
1A40  A1 D8	JZ	0x1C19	; USB_Not_Supported_Local_Drv
1A42  91 7B	CALL	0x1BBF	; USB_InitializeStatusBlock
1A44  55 0B 04	MOV	[0x0B],0x04 ; transferType
1A47  2E 1D 01	OR	[0x1D],0x01 ; datatoggle
1A4A  50 00	MOV	A,0x00
1A4C  57 0B	MOV	X,0x0B
1A4E  8F 66	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_ControlWriteDataStage:
1A50  36 1D 01	XOR	[0x1D],0x01 ; datatoggle
1A53  5D 41	MOV	A,REG[0x41] ; EP0CNT
1A55  21 0F	AND	A,0x0F
1A57  11 02	SUB	A,0x02
1A59  53 1F	MOV	[0x1F],A
1A5B  50 00	MOV	A,0x00
1A5D  3A 15	CMP	A,[0x15]
1A5F  B0 07	JNZ	0x1A67
1A61  51 1F	MOV	A,[0x1F]
1A63  3A 16	CMP	A,[0x16]
1A65  A0 06	JZ	0x1A6C
1A67  C0 04	JC	0x1A6C
1A69  5F 1F 16	MOV	[0x1F],[0x16]
1A6C  51 1F	MOV	A,[0x1F]
1A6E  14 16	SUB	[0x16],A
1A70  1E 15 00	SBB	[0x15],0x00
1A73  04 1C	ADD	[0x1C],A
1A75  0E 1B 00	ADC	[0x1B],0x00
1A78  57 00	MOV	X,0x00
1A7A  5E 50	MOV	A,REG[X+0x50]
1A7C  3F 18	MVI	[[0x18]++],A
1A7E  75	INC	X
1A7F  5B	MOV	A,X
1A80  3A 1F	CMP	A,[0x1F]
1A82  CF F7	JC	0x1A7A
1A84  50 00	MOV	A,0x00
1A86  57 0B	MOV	X,0x0B
1A88  8F 2C	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT
1A8A  55 0B 00	MOV	[0x0B],0x00
1A8D  50 00	MOV	A,0x00
1A8F  57 03	MOV	X,0x03
1A91  8F 23	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_ControlWriteStatusStage:
1A93  50 01	MOV	A,0x01
1A95  91 12	CALL	0x1BA9	; USB_UpdateStatusBlock
1A97  55 0B 00	MOV	[0x0B],0x00
1A9A  50 00	MOV	A,0x00
1A9C  57 03	MOV	X,0x03
1A9E  8F 16	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_NoDataControlStatusStage:
1AA0  50 01	MOV	A,0x01
1AA2  91 05	CALL	0x1BA9	; USB_UpdateStatusBlock
1AA4  3C 1E 01	CMP	[0x1E],0x01 ; fDataPending
1AA7  B0 09	JNZ	0x1AB1
1AA9  51 0C	MOV	A,[0x0C] ; transferBuffer
1AAB  29 80	OR	A,0x80	 ; enable
1AAD  60 40	MOV	REG[0x40],A ; USBCR
1AAF  80 01	JMP	0x1AB1
1AB1  55 1E 00	MOV	[0x1E],0x00
1AB4  50 00	MOV	A,0x00	; fDataPending
1AB6  57 06	MOV	X,0x06
1AB8  8E FC	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_NoDataControlError:
1ABA  50 03	MOV	A,0x03
1ABC  90 EB	CALL	0x1BA9	; USB_UpdateStatusBlock
1ABE  50 00	MOV	A,0x00
1AC0  57 03	MOV	X,0x03	; USB_MODE_STALL_IN_OUT
1AC2  8E F2	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_LoadEndpoint:
1AC4  51 0A	MOV	A,[0x0A]
1AC6  04 1C	ADD	[0x1C],A
1AC8  0E 1B 00	ADC	[0x1B],0x00
1ACB  51 15	MOV	A,[0x15]
1ACD  2A 16	OR	A,[0x16]
1ACF  B0 0E	JNZ	0x1ADE
1AD1  3C 0A 08	CMP	[0x0A],0x08
1AD4  A0 47	JZ	0x1B1C
1AD6  50 00	MOV	A,0x00
1AD8  53 0A	MOV	[0x0A],A
1ADA  57 02	MOV	X,0x02
1ADC  8E D8	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT
1ADE  3C 15 00	CMP	[0x15],0x00
1AE1  B0 0A	JNZ	0x1AEC
1AE3  3C 16 08	CMP	[0x16],0x08
1AE6  D0 05	JNC	0x1AEC
1AE8  51 16	MOV	A,[0x16]
1AEA  80 03	JMP	0x1AEE
1AEC  50 08	MOV	A,0x08
1AEE  14 16	SUB	[0x16],A
1AF0  1E 15 00	SBB	[0x15],0x00
1AF3  53 1F	MOV	[0x1F],A
1AF5  57 00	MOV	X,0x00
1AF7  3C 14 00	CMP	[0x14],0x00
1AFA  B0 17	JNZ	0x1B12
1AFC  10	PUSH	X
1AFD  51 17	MOV	A,[0x17]
1AFF  58 18	MOV	X,[0x18]
1B01  76 18	INC	[0x18]
1B03  0E 17 00	ADC	[0x17],0x00
1B06  28	ROMX
1B07  20	POP	X
1B08  61 50	MOV	REG[X+0x50],A
1B0A  75	INC	X
1B0B  5B	MOV	A,X
1B0C  3A 1F	CMP	A,[0x1F]
1B0E  CF ED	JC	0x1AFC
1B10  80 0B	JMP	0x1B1C
1B12  3E 18	MVI	A,[[0x18]++]
1B14  61 50	MOV	REG[X+0x50],A
1B16  75	INC	X
1B17  5B	MOV	A,X
1B18  3A 1F	CMP	A,[0x1F]
1B1A  CF F7	JC	0x1B12
1B1C  53 0A	MOV	[0x0A],A
1B1E  50 01	MOV	A,0x01
1B20  22 1D	AND	A,[0x1D]
1B22  A0 03	JZ	0x1B26
1B24  50 80	MOV	A,0x80
1B26  2A 0A	OR	A,[0x0A]
1B28  36 1D 01	XOR	[0x1D],0x01
1B2B  57 0F	MOV	X,0x0F
1B2D  8E 87	JMP	0x19B5	; USB_EP0_UPD_MODE_EXIT

USB_GetTableEntry:
1B2F  75	INC	X
1B30  09 00	ADC	A,0x00
1B32  08	PUSH	A
1B33  65 1F	ASL	[0x1F]
1B35  65 1F	ASL	[0x1F]
1B37  65 1F	ASL	[0x1F]
1B39  18	POP	A
1B3A  4B	SWAP	A,X
1B3B  02 1F	ADD	A,[0x1F]
1B3D  4B	SWAP	A,X
1B3E  09 00	ADC	A,0x00
1B40  55 1F 14	MOV	[0x1F],0x14
1B43  90 26	CALL	0x1B6B	; USB_GETBYTE
1B45  90 1C	CALL	0x1B63	; USB_GETWORD
1B47  90 1A	CALL	0x1B63	; USB_GETWORD
1B49  90 18	CALL	0x1B63	; USB_GETWORD
1B4B  5D 50	MOV	A,REG[0x50]
1B4D  21 80	AND	A,0x80 	; read/write?
1B4F  A0 03	JZ	0x1B53
1B51  8E A3	JMP	0x19F5	; USB_InitControlRead
1B53  8E E8	JMP	0x1A3C	; USB_InitControlWrite

USB_LOOKUP:
1B55  75	INC	X
1B56  09 00	ADC	A,0x00
1B58  65 1F	ASL	[0x1F]
1B5A  65 1F	ASL	[0x1F]
1B5C  4B	SWAP	A,X
1B5D  02 1F	ADD	A,[0x1F]
1B5F  4B	SWAP	A,X
1B60  09 00	ADC	A,0x00
1B62  7F	RET

USB_GETWORD:
1B63  08	PUSH	A
1B64  28	ROMX
1B65  3F 1F	MVI	[[0x1F]++],A
1B67  18	POP	A
1B68  75	INC	X
1B69  09 00	ADC	A,0x00

USB_GETBYTE:
1B6B  08	PUSH	A
1B6C  28	ROMX
1B6D  3F 1F	MVI	[[0x1F]++],A
1B6F  18	POP	A
1B70  75	INC	X
1B71  09 00	ADC	A,0x00
1B73  7F	RET

USB_GET_TABLE_PTR:
1B74  64	ASL	A
1B75  5C	MOV	X,A
1B76  50 01	MOV	A,0x01	; USB_VECTOR_TABLE
1B78  28	ROMX
1B79  08	PUSH	A
1B7A  75	INC	X
1B7B  50 01	MOV	A,0x01	; USB_VECTOR_TABLE
1B7D  28	ROMX
1B7E  20	POP	X
1B7F  4B	SWAP	A,X
1B80  7F	RET

USB_GET_DEVICE_TABLE_ENTRY:
1B81  5F 1F 02	MOV	[0x1F],[0x02]
1B84  50 00	MOV	A,0x00
1B86  9F EC	CALL	0x1B74	; USB_GET_TABLE_PTR
1B88  08	PUSH	A
1B89  28	ROMX
1B8A  3A 1F	CMP	A,[0x1F]
1B8C  18	POP	A
1B8D  C0 03	JC	0x1B91
1B8F  9F C4	CALL	0x1B55	; func35
1B91  7F	RET

USB_GET_CONFIG_TABLE_ENTRY:
1B92  9F ED	CALL	0x1B81	; USB_GET_DEVICE_TABLE_ENTRY
1B94  55 1F 20	MOV	[0x1F],0x20
1B97  9F CA	CALL	0x1B63	; USB_GETWORD
1B99  5D 52	MOV	A,REG[0x52]
1B9B  53 1F	MOV	[0x1F],A
1B9D  51 20	MOV	A,[0x20]
1B9F  58 21	MOV	X,[0x21]
1BA1  5F 1F 03	MOV	[0x1F],[0x03]
1BA4  7A 1F	DEC	[0x1F]
1BA6  9F AD	CALL	0x1B55	; USB_LOOKUP
1BA8  7F	RET

USB_UpdateStatusBlock:
1BA9  58 1A	MOV	X,[0x1A]
1BAB  4B	SWAP	A,X
1BAC  39 00	CMP	A,0x00
1BAE  A0 0F	JZ	0x1BBE
1BB0  4B	SWAP	A,X
1BB1  54 00	MOV	[X+0x00],A
1BB3  51 1B	MOV	A,[0x1B]
1BB5  54 01	MOV	[X+0x01],A
1BB7  51 1C	MOV	A,[0x1C]
1BB9  54 02	MOV	[X+0x02],A
1BBB  55 1A 00	MOV	[0x1A],0x00
1BBE  7F	RET

USB_InitializeStatusBlock:
1BBF  51 1A	MOV	A,[0x1A]
1BC1  39 00	CMP	A,0x00
1BC3  A0 0B	JZ	0x1BCF
1BC5  4B	SWAP	A,X
1BC6  56 00 00	MOV	[X+0x00],0x00
1BC9  55 1B 00	MOV	[0x1B],0x00
1BCC  55 1C 00	MOV	[0x1C],0x00
1BCF  7F	RET

USB_DT_bmRequestType:
1BD0  8D 46	JMP	0x1917	; out, standard, dev
1BD2  8D 79	JMP	0x194C	; out, standard, intf
1BD4  8D AF	JMP	0x1984	; out, standard, endp
1BD6  80 42	JMP	0x1C19	; out, standard, other
1BD8  80 40	JMP	0x1C19	; out, class, dev
1BDA  81 B4	JMP	0x1D8F	; out, class, intf
1BDC  80 3C	JMP	0x1C19	; out, class, endp
1BDE  80 3A	JMP	0x1C19	; out, class, other
1BE0  80 38	JMP	0x1C19	; out, vendor, dev
1BE2  80 36	JMP	0x1C19	; out, vendor, intf
1BE4  80 34	JMP	0x1C19	; out, vendor, endp
1BE6  80 32	JMP	0x1C19	; out, vendor, other
1BE8  80 30	JMP	0x1C19	; out, reserved, dev
1BEA  80 2E	JMP	0x1C19	; out, reserved, intf
1BEC  80 2C	JMP	0x1C19	; out, reserved, endp
1BEE  80 2A	JMP	0x1C19	; out, reserved, other
1BF0  8D 07	JMP	0x18F8	; in, standard, dev
1BF2  8D 45	JMP	0x1938
1BF4  8D 6B	JMP	0x1960
1BF6  80 22	JMP	0x1C19
1BF8  80 20	JMP	0x1C19
1BFA  81 AE	JMP	0x1DA9
1BFC  80 1C	JMP	0x1C19
1BFE  80 1A	JMP	0x1C19
1C00  80 18	JMP	0x1C19
1C02  80 16	JMP	0x1C19
1C04  80 14	JMP	0x1C19
1C06  80 12	JMP	0x1C19
1C08  80 10	JMP	0x1C19
1C0A  80 0E	JMP	0x1C19
1C0C  80 0C	JMP	0x1C19
1C0E  80 0A	JMP	0x1C19

USB_bmRequestType_Dispatch:
1C10  39 20	CMP	A,0x20
1C12  D0 04	JNC	0x1C17
1C14  64	ASL	A
1C15  EF BA	JACC	0x1BD0	; USB_DT_bmRequestType
1C17  80 01	JMP	0x1C19	; USB_Not_Supported_Local_Drv

USB_Not_Supported_Local_Drv:
1C19  7D 16 F6	LJMP	0x16F6	; func27

USB_bGetProtocol:
1C1C  5C	MOV	X,A
1C1D  52 29	MOV	A,[X+0x29] ; Protocol
1C1F  7F	RET

USB_UpdateHIDTimer:
1C20  5C	MOV	X,A
1C21  3D 25 00	CMP	[X+0x25],0x00 ; IdleReload
1C24  A0 0F	JZ	0x1C34
1C26  7B 27	DEC	[X+0x27] ; IdleTimer
1C28  C0 04	JC	0x1C2D
1C2A  50 02	MOV	A,0x02
1C2C  7F	RET
1C2D  52 25	MOV	A,[X+0x25]
1C2F  54 27	MOV	[X+0x27],A
1C31  50 01	MOV	A,0x01
1C33  7F	RET
1C34  50 00	MOV	A,0x00
1C36  7F	RET

USB_CB_d2h_std_ifc_06:	; GET_INTERFACE_DESCRIPTOR
1C37  91 2A	CALL	0x1D63	; USB_GetInterfaceLookupTable
1C39  08	PUSH	A
1C3A  5D 53	MOV	A,REG[0x53] ; valueH
1C3C  39 21	CMP	A,0x21	    ; HID CLASS
1C3E  A0 0E	JZ	0x1C4D
1C40  39 22	CMP	A,0x22	; HID REPORT
1C42  A0 04	JZ	0x1C47
1C44  18	POP	A
1C45  81 75	JMP	0x1DBB	; USB_Not_Supported_Local_HID
1C47  18	POP	A
1C48  4B	SWAP	A,X
1C49  01 02	ADD	A,0x02
1C4B  80 05	JMP	0x1C51
1C4D  18	POP	A
1C4E  4B	SWAP	A,X
1C4F  01 04	ADD	A,0x04
1C51  4B	SWAP	A,X
1C52  09 00	ADC	A,0x00
1C54  55 1F 20	MOV	[0x1F],0x20
1C57  7C 1B 63	LCALL	0x1B63	; USB_GETWORD
1C5A  5D 54	MOV	A,REG[0x54] ; indexL
1C5C  53 1F	MOV	[0x1F],A    ; t2
1C5E  51 20	MOV	A,[0x20]    ; t1
1C60  58 21	MOV	X,[0x21]
1C62  81 5B	JMP	0x1DBE	; USB_GetTableEntry_Local_HID

USB_CB_d2h_cls_ifc_01:
1C64  90 91	CALL	0x1CF7	; Find_Report
1C66  4B	SWAP	A,X
1C67  B0 06	JNZ	0x1C6E
1C69  4B	SWAP	A,X
1C6A  A1 50	JZ	0x1DBB	; ep0_stall
1C6C  80 02	JMP	0x1C6F
1C6E  4B	SWAP	A,X
1C6F  81 4E	JMP	0x1DBE	; USB_GetTableEntry_Local_HID

GetSetIdleTable:
1C71  01 01 00 01 00 25 00 00 DE 01 00 01 00 26 00 00 DE

USB_CB_d2h_cls_ifc_02:		    ; GET_IDLE
1C82  5D 52	MOV	A,REG[0x52] ; valueL
1C84  39 00	CMP	A,0x00
1C86  B1 34	JNZ	0x1DBB	; USB_Not_Supported_Local_HID
1C88  5D 54	MOV	A,REG[0x54] ; indexL
1C8A  39 02	CMP	A,0x02	; NumInstances
1C8C  D1 2E	JNC	0x1DBB	; USB_Not_Supported_Local_HID
1C8E  53 1F	MOV	[0x1F],A ; t2
1C90  50 1C	MOV	A,0x1C	 ; GetSetIdleTable
1C92  57 71	MOV	X,0x71
1C94  81 29	JMP	0x1DBE	; USB_GetTableEntry_Local_HID

GetProtocolTable:
1C96  01 00 00 01 1C A7 00 00 DE 00 00 01 1C A8 00 00 DE 01

USB_CB_SRC_d2h_cls_ifc_03:	; GET_PROTOCOL
1CA9  5D 54	MOV	A,REG[0x54] ; indexL
1CAB  39 02	CMP	A,0x02	; NumInstances
1CAD  D1 0D	JNC	0x1DBB	; USB_Not_Supported_Local_HID
1CAF  5C	MOV	X,A
1CB0  52 29	MOV	A,[X+0x29] ; Protocol
1CB2  53 1F	MOV	[0x1F],A   ; t2
1CB4  50 1C	MOV	A,0x1C	   ; GetProtocolTable
1CB6  57 96	MOV	X,0x96
1CB8  81 05	JMP	0x1DBE	; USB_GetTableEntry_Local_HID

USB_CB_h2d_cls_ifc_09:		; SET_REPORT
1CBA  90 3B	CALL	0x1CF7	; Find_Report
1CBC  4B	SWAP	A,X
1CBD  B0 06	JNZ	0x1CC4
1CBF  4B	SWAP	A,X
1CC0  A0 FA	JZ	0x1DBB	; USB_Not_Supported_Local_HID
1CC2  80 02	JMP	0x1CC5
1CC4  4B	SWAP	A,X
1CC5  80 F8	JMP	0x1DBE	 ; USB_GetTableEntry_Local_HID

USB_CB_h2d_cls_ifc_10:		    ; SET_IDLE
1CC7  5D 52	MOV	A,REG[0x52] ; valueL, report id
1CC9  39 00	CMP	A,0x00
1CCB  B0 EF	JNZ	0x1DBB	; USB_Not_Supported_Local_HID
1CCD  5D 54	MOV	A,REG[0x54] ; indexL
1CCF  39 02	CMP	A,0x02	    ; NumInterfaces
1CD1  D0 E9	JNC	0x1DBB	; USB_Not_Supported_Local_HID
1CD3  5C	MOV	X,A
1CD4  5D 53	MOV	A,REG[0x53] ; valueH, duration
1CD6  54 25	MOV	[X+0x25],A  ; IdleReload
1CD8  39 00	CMP	A,0x00
1CDA  A0 06	JZ	0x1CE1
1CDC  3D 27 01	CMP	[X+0x27],0x01 ; IdleTimer
1CDF  A0 03	JZ	0x1CE3
1CE1  54 27	MOV	[X+0x27],A ; IdleTimer
1CE3  8D 4D	JMP	0x1A31	; USB_NoDataStageControlTransfer

USB_CB_h2d_cls_ifc_11:		; SET_PROTOCOL
1CE5  5D 54	MOV	A,REG[0x54] ; indexL
1CE7  39 02	CMP	A,0x02
1CE9  D0 D1	JNC	0x1DBB	; USB_Not_Supported_Local_HID
1CEB  5C	MOV	X,A
1CEC  5D 52	MOV	A,REG[0x52] ; valueL
1CEE  39 02	CMP	A,0x02
1CF0  D0 CA	JNC	0x1DBB	; USB_Not_Supported_Local_HID
1CF2  54 29	MOV	[X+0x29],A ; Protocol
1CF4  7D 1A 31	LJMP	0x1A31	   ; USB_NoDataStageControlTransfer

Find_Report:
1CF7  90 6A	CALL	0x1D63	; USB_GetInterfaceLookupTable
1CF9  55 1F 20	MOV	[0x1F],0x20
1CFC  9E 65	CALL	0x1B63	; USB_GETWORD
1CFE  5D 54	MOV	A,REG[0x54] ; indexL
1D00  53 1F	MOV	[0x1F],A
1D02  51 20	MOV	A,[0x20]
1D04  58 21	MOV	X,[0x21]
1D06  65 1F	ASL	[0x1F]
1D08  4B	SWAP	A,X
1D09  02 1F	ADD	A,[0x1F]
1D0B  4B	SWAP	A,X
1D0C  09 00	ADC	A,0x00
1D0E  08	PUSH	A
1D0F  08	PUSH	A
1D10  28	ROMX
1D11  10	PUSH	X
1D12  4F	MOV	X,SP
1D13  54 FD	MOV	[X+0xFD],A
1D15  20	POP	X
1D16  18	POP	A
1D17  75	INC	X
1D18  09 00	ADC	A,0x00
1D1A  28	ROMX
1D1B  5C	MOV	X,A
1D1C  18	POP	A
1D1D  08	PUSH	A
1D1E  5D 53	MOV	A,REG[0x53] ; valueH (report type)
1D20  78	DEC	A
1D21  53 1F	MOV	[0x1F],A
1D23  18	POP	A
1D24  08	PUSH	A
1D25  28	ROMX
1D26  3A 1F	CMP	A,[0x1F]
1D28  C0 35	JC	0x1D5E
1D2A  18	POP	A
1D2B  75	INC	X
1D2C  09 00	ADC	A,0x00
1D2E  65 1F	ASL	[0x1F]
1D30  65 1F	ASL	[0x1F]
1D32  4B	SWAP	A,X
1D33  02 1F	ADD	A,[0x1F]
1D35  4B	SWAP	A,X
1D36  09 00	ADC	A,0x00
1D38  08	PUSH	A
1D39  08	PUSH	A
1D3A  28	ROMX
1D3B  10	PUSH	X
1D3C  4F	MOV	X,SP
1D3D  54 FD	MOV	[X+0xFD],A
1D3F  20	POP	X
1D40  18	POP	A
1D41  75	INC	X
1D42  09 00	ADC	A,0x00
1D44  28	ROMX
1D45  5C	MOV	X,A
1D46  18	POP	A
1D47  4B	SWAP	A,X
1D48  B0 06	JNZ	0x1D4F
1D4A  4B	SWAP	A,X
1D4B  A0 13	JZ	0x1D5F
1D4D  80 02	JMP	0x1D50
1D4F  4B	SWAP	A,X
1D50  08	PUSH	A
1D51  5D 52	MOV	A,REG[0x52] ; valueL (report ID)
1D53  53 1F	MOV	[0x1F],A
1D55  18	POP	A
1D56  08	PUSH	A
1D57  28	ROMX
1D58  3A 1F	CMP	A,[0x1F]
1D5A  C0 03	JC	0x1D5E
1D5C  18	POP	A
1D5D  7F	RET
1D5E  18	POP	A
1D5F  50 00	MOV	A,0x00
1D61  5C	MOV	X,A
1D62  7F	RET

USB_GetInterfaceLookupTable:
1D63  9E 2D	CALL	0x1B92	; USB_GET_CONFIG_TABLE_ENTRY
1D65  4B	SWAP	A,X
1D66  01 02	ADD	A,0x02
1D68  4B	SWAP	A,X
1D69  09 00	ADC	A,0x00
1D6B  55 1F 20	MOV	[0x1F],0x20
1D6E  9D F3	CALL	0x1B63	; USB_GETWORD
1D70  51 20	MOV	A,[0x20]
1D72  58 21	MOV	X,[0x21]
1D74  7F	RET

USB_DT_h2d_cls_ifc:
1D75  80 45	JMP	0x1DBB	; reserved
1D77  80 43	JMP	0x1DBB	; GET_REPORT
1D79  80 41	JMP	0x1DBB	; GET_IDLE
1D7B  80 3F	JMP	0x1DBB	; GET_PROTOCOL
1D7D  80 3D	JMP	0x1DBB	; reserved
1D7F  80 3B	JMP	0x1DBB	; reserved
1D81  80 39	JMP	0x1DBB	; reserved
1D83  80 37	JMP	0x1DBB	; reserved
1D85  80 35	JMP	0x1DBB	; reserved
1D87  8F 32	JMP	0x1CBA	; SET_REPORT
1D89  8F 3D	JMP	0x1CC7	; SET_IDLE
1D8B  8F 59	JMP	0x1CE5	; SET_PROTOCL
1D8D  80 2D	JMP	0x1DBB	; reserved

USB_DT_h2d_cls_ifc_Dispatch:
1D8F  3C 03 00	CMP	[0x03],0x00 ; Configuration
1D92  B0 03	JNZ	0x1D96
1D94  80 26	JMP	0x1DBB	    ; USB_Not_Supported_Local_HID
1D96  5D 51	MOV	A,REG[0x51] ; bRequest
1D98  39 0D	CMP	A,0x0D
1D9A  D0 04	JNC	0x1D9F	; bRequest >= 0xd
1D9C  64	ASL	A
1D9D  EF D7	JACC	0x1D75	; USB_DT_h2d_cls_ifc
1D9F  80 1B	JMP	0x1DBB	; USB_Not_Supported_Local_HID

USB_DT_d2h_cls_ifc:
1DA1  80 19	JMP	0x1DBB	; USB_Not_Supported_Local_HID
1DA3  8E C0	JMP	0x1C64	; USB_CB_d2h_cls_ifc_01
1DA5  8E DC	JMP	0x1C82	; USB_CB_d2h_cls_ifc_02
1DA7  8F 01	JMP	0x1CA9	; USB_CB_d2h_cls_ifc_03

USB_DT_d2h_cls_ifc_Dispatch
1DA9  3C 03 00	CMP	[0x03],0x00 ; Configuration
1DAC  B0 03	JNZ	0x1DB0
1DAE  80 0C	JMP	0x1DBB	; USB_Not_Supported_Local_HID
1DB0  5D 51	MOV	A,REG[0x51] ; bRequest
1DB2  39 04	CMP	A,0x04
1DB4  D0 04	JNC	0x1DB9
1DB6  64	ASL	A
1DB7  EF E9	JACC	0x1DA1	; USB_DT_d2h_cls_ifc
1DB9  80 01	JMP	0x1DBB	; ep0_stall

USB_Not_Supported_Local_HID:
1DBB  7D 16 F6	LJMP	0x16F6	; USB_Not_Supported

USB_GetTableEntry_Local_HID
1DBE  7D 1B 2F	LJMP	0x1B2F	; USB_GetTableEntry


USB_USB_EP_BIT_LOOKUP:
1DC1  01 02 04			; data

USB_Start:
1DC4  62 0D 00	MOV	REG[0x0D],0x00
1DC7  62 0E 00	MOV	REG[0x0E],0x00
1DCA  53 02	MOV	[0x02],A ; bCurrentDevice
1DCC  55 0B 00	MOV	[0x0B],0x00 ; transferType
1DCF  55 03 00	MOV	[0x03],0x00 ; Configuration
1DD2  55 04 00	MOV	[0x04],0x00 ; DeviceStatus
1DD5  55 1D 00	MOV	[0x1D],0x00 ; datatoggle
1DD8  62 40 80	MOV	REG[0x40],0x80
1DDB  43 74 80	OR	REG[0x74],0x80
1DDE  62 44 03	MOV	REG[0x44],0x03
1DE1  40	NOP
1DE2  5D 44	MOV	A,REG[0x44]
1DE4  43 E1 19	OR	REG[0xE1],0x19
1DE7  7F	RET

USB_Stop:
1DE8  55 02 00	MOV	[0x02],0x00 ; bCurrentDevice
1DEB  55 0B 00	MOV	[0x0B],0x00 ; transferType
1DEE  55 03 00	MOV	[0x03],0x00 ; Configuration
1DF1  55 04 00	MOV	[0x04],0x00 ; DeviceStatus
1DF4  55 2F 00	MOV	[0x2F],0x00 ; bActivity
1DF7  62 40 00	MOV	REG[0x40],0x00
1DFA  41 74 7F	AND	REG[0x74],0x7F
1DFD  41 E1 E0	AND	REG[0xE1],0xE0
1E00  7F	RET

USB_bCheckActivity:
1E01  51 2F	MOV	A,[0x2F] ; bActivity
1E03  39 01	CMP	A,0x01
1E05  A0 02	JZ	0x1E08
1E07  7F	RET
1E08  55 2F 00	MOV	[0x2F],0x00 ; deactivate
1E0B  43 E1 10	OR	REG[0xE1],0x10
1E0E  7F	RET

USB_bGetConfiguration:
1E0F  51 03	MOV	A,[0x03] ; Configuration
1E11  7F	RET

USB_bGetEPState:
1E12  39 03	CMP	A,0x03	; invalid EP?
1E14  D0 06	JNC	0x1E1B
1E16  5C	MOV	X,A
1E17  52 22	MOV	A,[X+0x22] ; apistatus
1E19  80 03	JMP	0x1E1D
1E1B  50 00	MOV	A,0x00
1E1D  7F	RET

USB_bRWUEnabled:
1E1E  47 04 02	TST	[0x04],0x02 ; DeviceStatus, USB_DEVICE_STATUS_REMOTE_WAKEUP
1E21  B0 05	JNZ	0x1E27
1E23  50 00	MOV	A,0x00
1E25  80 03	JMP	0x1E29
1E27  50 01	MOV	A,0x01
1E29  7F	RET

USB_bGetEPCount:
1E2A  39 03	CMP	A,0x03
1E2C  D0 0A	JNC	0x1E37
1E2E  5C	MOV	X,A
1E2F  5E 41	MOV	A,REG[X+0x41]
1E31  21 1F	AND	A,0x1F
1E33  11 02	SUB	A,0x02
1E35  80 03	JMP	0x1E39
1E37  50 00	MOV	A,0x00
1E39  7F	RET

USB_XLoadEP:
1E3A  3C 2D 03	CMP	[0x2D],0x03
1E3D  D0 3F	JNC	0x1E7D
1E3F  5A 2B	MOV	[0x2B],X
1E41  51 2D	MOV	A,[0x2D]
1E43  F0 39	INDEX	0x1E7E
1E45  5C	MOV	X,A
1E46  51 2E	MOV	A,[0x2E]
1E48  53 2C	MOV	[0x2C],A
1E4A  7A 2C	DEC	[0x2C]
1E4C  C0 08	JC	0x1E55
1E4E  3E 2B	MVI	A,[[0x2B]++]
1E50  61 00	MOV	REG[X+0x00],A
1E52  75	INC	X
1E53  8F F6	JMP	0x1E4A
1E55  58 2D	MOV	X,[0x2D]
1E57  5B	MOV	A,X
1E58  FF 67	INDEX	0x1DC1	; USB_USB_EP_BIT_LOOKUP
1E5A  22 1D	AND	A,[0x1D]
1E5C  A0 03	JZ	0x1E60
1E5E  50 80	MOV	A,0x80
1E60  2A 2E	OR	A,[0x2E]
1E62  61 41	MOV	REG[X+0x41],A
1E64  56 22 00	MOV	[X+0x22],0x00
1E67  5D F7	MOV	A,REG[0xF7]
1E69  53 2B	MOV	[0x2B],A
1E6B  70 FE	AND	F,0xFE
1E6D  63 44 0D	MOV	REG[X+0x44],0x0D
1E70  5E 44	MOV	A,REG[X+0x44]
1E72  39 0D	CMP	A,0x0D
1E74  BF F8	JNZ	0x1E6D
1E76  47 2B 01	TST	[0x2B],0x01
1E79  A0 03	JZ	0x1E7D
1E7B  71 01	OR	F,0x01
1E7D  7F	RET
1E7E  50 58 60			; EP0DATA, EP1DATA, EP2DATA

USB_EnableOutEP:
1E81  39 00	CMP	A,0x00
1E83  A0 0E	JZ	0x1E92
1E85  39 03	CMP	A,0x03
1E87  D0 0A	JNC	0x1E92
1E89  5C	MOV	X,A
1E8A  56 22 00	MOV	[X+0x22],0x00
1E8D  5E 44	MOV	A,REG[X+0x44]
1E8F  63 44 09	MOV	REG[X+0x44],0x09
1E92  7F	RET

USB_DisableOutEP:
1E93  39 00	CMP	A,0x00
1E95  A0 0B	JZ	0x1EA1
1E97  39 03	CMP	A,0x03
1E99  D0 07	JNC	0x1EA1
1E9B  5C	MOV	X,A
1E9C  5E 44	MOV	A,REG[X+0x44]
1E9E  63 44 08	MOV	REG[X+0x44],0x08
1EA1  7F	RET

USB_Force:
1EA2  39 FF	CMP	A,0xFF
1EA4  A0 28	JZ	0x1ECD
1EA6  39 02	CMP	A,0x02
1EA8  B0 09	JNZ	0x1EB2
1EAA  2E 58 02	OR	[0x58],0x02
1EAD  26 58 FE	AND	[0x58],0xFE
1EB0  80 14	JMP	0x1EC5
1EB2  39 01	CMP	A,0x01
1EB4  B0 09	JNZ	0x1EBE
1EB6  2E 58 01	OR	[0x58],0x01
1EB9  26 58 FD	AND	[0x58],0xFD
1EBC  80 08	JMP	0x1EC5
1EBE  39 00	CMP	A,0x00
1EC0  A0 0F	JZ	0x1ED0
1EC2  26 58 FC	AND	[0x58],0xFC
1EC5  51 58	MOV	A,[0x58]
1EC7  60 01	MOV	REG[0x01],A
1EC9  43 74 01	OR	REG[0x74],0x01
1ECC  7F	RET
1ECD  41 74 FE	AND	REG[0x74],0xFE
1ED0  7F	RET

USB_Suspend:
1ED1  41 40 7F	AND	REG[0x40],0x7F
1ED4  7F	RET

USB_Resume:
1ED5  43 40 80	OR	REG[0x40],0x80
1ED8  7F	RET

delay:
1ED9  57 0A	MOV	X,0x0A
1EDB  79	DEC	X
1EDC  50 00	MOV	A,0x00
1EDE  74	INC	A
1EDF  39 D4	CMP	A,0xD4
1EE1  BF FC	JNZ	0x1EDE
1EE3  62 E3 00	MOV	REG[0xE3],0x00
1EE6  5B	MOV	A,X
1EE7  39 00	CMP	A,0x00
1EE9  BF F1	JNZ	0x1EDB
1EEB  51 67	MOV	A,[0x67] ; delay
1EED  78	DEC	A
1EEE  53 67	MOV	[0x67],A
1EF0  39 00	CMP	A,0x00
1EF2  BF E6	JNZ	0x1ED9
1EF4  7F	RET

bootCustomUserCode:
1EF5  62 E0 10	MOV	REG[0xE0],0x10
1EF8  62 E3 00	MOV	REG[0xE3],0x00 ; RESWDT
1EFB  62 73 01	MOV	REG[0x73],0x01
1EFE  62 05 01	MOV	REG[0x05],0x01 ; GPIO0.0 as output
1F01  62 06 01	MOV	REG[0x06],0x01 ; GPIO0.1 as output
1F04  62 07 10	MOV	REG[0x07],0x10 ; GPIO0.2 as input
1F07  62 08 01	MOV	REG[0x08],0x01 ; GPIO0.3 as output
1F0A  62 09 01	MOV	REG[0x09],0x01 ; GPIO0.4 as output
1F0D  62 0B 01	MOV	REG[0x0B],0x01 ; GPIO0.6 as output
1F10  62 0C 01	MOV	REG[0x0C],0x01 ; GPIO0.7 as output
1F13  62 10 13	MOV	REG[0x10],0x13
1F16  62 11 11	MOV	REG[0x11],0x11
1F19  62 12 10	MOV	REG[0x12],0x10
1F1C  62 13 10	MOV	REG[0x13],0x10
1F1F  62 14 01	MOV	REG[0x14],0x01
1F22  62 00 01	MOV	REG[0x00],0x01 ; P0DATA
1F25  62 E0 10	MOV	REG[0xE0],0x10 ; INT_MSK0 (enable gpio0 int)
1F28  5D 00	MOV	A,REG[0x00] ; P0DATA
1F2A  29 08	OR	A,0x08
1F2C  60 00	MOV	REG[0x00],A ; P0DATA (3/0)
1F2E  5D 01	MOV	A,REG[0x01] ; P1DATA
1F30  29 08	OR	A,0x08
1F32  60 01	MOV	REG[0x01],A ; P1DATA
1F34  5D 01	MOV	A,REG[0x01] ; P1DATA
1F36  21 EF	AND	A,0xEF
1F38  60 01	MOV	REG[0x01],A ; P1DATA
1F3A  55 67 FA	MOV	[0x67],0xFA
1F3D  9F 9A	CALL	0x1ED9	    ; delay
1F3F  5D 01	MOV	A,REG[0x01] ; P1DATA
1F41  21 EF	AND	A,0xEF
1F43  60 01	MOV	REG[0x01],A ; P1DATA
1F45  55 67 02	MOV	[0x67],0x02
1F48  9F 8F	CALL	0x1ED9	    ; delay
1F4A  5D 01	MOV	A,REG[0x01] ; P1DATA
1F4C  29 10	OR	A,0x10
1F4E  60 01	MOV	REG[0x01],A ; P1DATA
1F50  55 67 0F	MOV	[0x67],0x0F
1F53  9F 84	CALL	0x1ED9	    ; delay
1F55  5D 01	MOV	A,REG[0x01] ; P1DATA
1F57  21 F7	AND	A,0xF7
1F59  60 01	MOV	REG[0x01],A ; P1DATA
1F5B  55 67 05	MOV	[0x67],0x05
1F5E  9F 79	CALL	0x1ED9	    ; delay
1F60  5D 01	MOV	A,REG[0x01] ; P1DATA
1F62  29 08	OR	A,0x08
1F64  60 01	MOV	REG[0x01],A ; P1DATA
1F66  55 67 D0	MOV	[0x67],0xD0
1F69  57 0A	MOV	X,0x0A
1F6B  62 E3 00	MOV	REG[0xE3],0x00
1F6E  79	DEC	X
1F6F  50 00	MOV	A,0x00
1F71  74	INC	A
1F72  39 D4	CMP	A,0xD4
1F74  BF FC	JNZ	0x1F71
1F76  5B	MOV	A,X
1F77  39 00	CMP	A,0x00
1F79  BF F1	JNZ	0x1F6B
1F7B  5D 00	MOV	A,REG[0x00] ; P0DATA
1F7D  21 04	AND	A,0x04
1F7F  B0 12	JNZ	0x1F92
1F81  51 67	MOV	A,[0x67]
1F83  78	DEC	A
1F84  53 67	MOV	[0x67],A
1F86  39 00	CMP	A,0x00
1F88  BF E0	JNZ	0x1F69
1F8A  5D 01	MOV	A,REG[0x01] ; P0DATA
1F8C  21 EF	AND	A,0xEF
1F8E  60 01	MOV	REG[0x01],A
1F90  80 0C	JMP	0x1F9D
1F92  55 67 0A	MOV	[0x67],0x0A
1F95  9F 42	CALL	0x1ED9	    ; delay
1F97  5D 00	MOV	A,REG[0x00] ; P0DATA
1F99  29 40	OR	A,0x40
1F9B  60 00	MOV	REG[0x00],A ; P0DATA
1F9D  62 E3 00	MOV	REG[0xE3],0x00
1FA0  7F	RET

1FA1  30	HALT
1FA2  30	HALT
1FA3  30	HALT
1FA4  30	HALT
1FA5  30	HALT
1FA6  30	HALT
1FA7  30	HALT
1FA8  30	HALT
1FA9  30	HALT
1FAA  30	HALT
1FAB  30	HALT
1FAC  30	HALT
1FAD  30	HALT
1FAE  30	HALT
1FAF  30	HALT
1FB0  30	HALT
1FB1  30	HALT
1FB2  30	HALT
1FB3  30	HALT
1FB4  30	HALT
1FB5  30	HALT
1FB6  30	HALT
1FB7  30	HALT
1FB8  30	HALT
1FB9  30	HALT
1FBA  30	HALT
1FBB  30	HALT
1FBC  30	HALT
1FBD  30	HALT
1FBE  30	HALT
1FBF  30	HALT
1FC0  00	SSC
1FC1  00	SSC
1FC2  00	SSC
1FC3  00	SSC
1FC4  00	SSC
1FC5  00	SSC
1FC6  00	SSC
1FC7  00	SSC
1FC8  00	SSC
1FC9  00	SSC
1FCA  00	SSC
1FCB  00	SSC
1FCC  00	SSC
1FCD  00	SSC
1FCE  00	SSC
1FCF  00	SSC
1FD0  00	SSC
1FD1  00	SSC
1FD2  00	SSC
1FD3  00	SSC
1FD4  00	SSC
1FD5  00	SSC
1FD6  00	SSC
1FD7  00	SSC
1FD8  00	SSC
1FD9  00	SSC
1FDA  00	SSC
1FDB  00	SSC
1FDC  00	SSC
1FDD  00	SSC
1FDE  00	SSC
1FDF  00	SSC
1FE0  00	SSC
1FE1  00	SSC
1FE2  00	SSC
1FE3  00	SSC
1FE4  00	SSC
1FE5  00	SSC
1FE6  00	SSC
1FE7  00	SSC
1FE8  00	SSC
1FE9  00	SSC
1FEA  00	SSC
1FEB  00	SSC
1FEC  00	SSC
1FED  00	SSC
1FEE  00	SSC
1FEF  00	SSC
1FF0  00	SSC
1FF1  00	SSC
1FF2  00	SSC
1FF3  00	SSC
1FF4  00	SSC
1FF5  00	SSC
1FF6  00	SSC
1FF7  00	SSC
1FF8  00	SSC
1FF9  00	SSC
1FFA  00	SSC
1FFB  00	SSC
1FFC  00	SSC
1FFD  00	SSC
1FFE  19 0F	SBB	A,0x0F
